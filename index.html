<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CV Studio - محرر السير الذاتية الاحترافي المتوافق مع أنظمة التوظيف">
  <meta name="theme-color" content="#0B3D91">
  
  <title>CV Studio - محرر السير الذاتية الاحترافي</title>
  
  <!-- الخطوط -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    /* ============================================
       CV Studio - نمط عام وتصميم الموقع
       ============================================ */

    :root {
      /* الألوان الأساسية */
      --primary: #0B3D91;
      --primary-dark: #082E6F;
      --accent: #C99A6B;
      --accent-dark: #B8885A;
      --background: #F7F8FA;
      --surface: #FFFFFF;
      --muted: #6B7280;
      --success: #10B981;
      --error: #EF4444;
      --warning: #F59E0B;
      --border: #E5E7EB;
      --text-primary: #1F2937;
      --text-secondary: #4B5563;
      
      /* الخطوط */
      --font-family: 'Inter', 'Noto Sans Arabic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      --font-size-xs: 0.75rem;
      --font-size-sm: 0.875rem;
      --font-size-base: 1rem;
      --font-size-lg: 1.125rem;
      --font-size-xl: 1.25rem;
      --font-size-2xl: 1.5rem;
      --font-size-3xl: 1.875rem;
      --font-size-4xl: 2.25rem;
      --font-size-5xl: 3rem;
      
      /* المسافات */
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      --spacing-2xl: 3rem;
      --spacing-3xl: 4rem;
      
      /* الظلال */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      
      /* الزوايا */
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --radius-2xl: 1.5rem;
    }

    /* اتجاه RTL افتراضي */
    html {
      direction: rtl;
      text-align: right;
    }

    html[lang="en"] {
      direction: ltr;
      text-align: left;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      line-height: 1.6;
      color: var(--text-primary);
      background-color: var(--background);
      overflow-x: hidden;
      font-weight: 400;
    }

    /* ============================================
       النصوص والعناوين
       ============================================ */

    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.3;
      margin-bottom: var(--spacing-md);
      color: var(--text-primary);
    }

    h1 { 
      font-size: var(--font-size-4xl);
      font-weight: 700;
    }
    
    h2 { 
      font-size: var(--font-size-3xl);
      font-weight: 600;
    }
    
    h3 { 
      font-size: var(--font-size-2xl);
      font-weight: 600;
    }
    
    h4 { 
      font-size: var(--font-size-xl);
      font-weight: 600;
    }
    
    h5 { 
      font-size: var(--font-size-lg);
      font-weight: 600;
    }
    
    h6 { 
      font-size: var(--font-size-base);
      font-weight: 600;
    }

    p {
      margin-bottom: var(--spacing-md);
      color: var(--text-secondary);
    }

    /* ============================================
       الروابط - تحسينات شاملة
       ============================================ */

    a {
      color: var(--primary);
      text-decoration: none;
      transition: all 0.3s ease;
      position: relative;
    }

    a:hover {
      color: var(--primary-dark);
    }

    /* تأثير الخط السفلي المتحرك */
    .nav-link {
      position: relative;
      padding-bottom: 2px;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: 0;
      right: 0;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width 0.3s ease;
    }

    .nav-link:hover::after {
      width: 100%;
    }

    /* ============================================
       الأزرار
       ============================================ */

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-md) var(--spacing-lg);
      font-size: var(--font-size-base);
      font-weight: 500;
      border: none;
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      white-space: nowrap;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }

    .btn:hover::before {
      transform: translateX(0);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      box-shadow: 0 4px 14px 0 rgba(11, 61, 145, 0.3);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      box-shadow: 0 6px 20px 0 rgba(11, 61, 145, 0.4);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      color: white;
      box-shadow: 0 4px 14px 0 rgba(201, 154, 107, 0.3);
    }

    .btn-secondary:hover {
      background: linear-gradient(135deg, var(--accent-dark) 0%, var(--accent) 100%);
      box-shadow: 0 6px 20px 0 rgba(201, 154, 107, 0.4);
      transform: translateY(-2px);
    }

    .btn-outline {
      background-color: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
    }

    .btn-outline:hover {
      background-color: var(--primary);
      color: white;
      transform: translateY(-2px);
    }

    .btn-small {
      padding: var(--spacing-sm) var(--spacing-md);
      font-size: var(--font-size-sm);
    }

    .btn-large {
      padding: var(--spacing-lg) var(--spacing-2xl);
      font-size: var(--font-size-lg);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ============================================
       البطاقات والحاويات
       ============================================ */

    .card {
      background-color: var(--surface);
      border-radius: var(--radius-xl);
      padding: var(--spacing-xl);
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      border: 1px solid var(--border);
    }

    .card:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-4px);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--spacing-lg);
    }

    .container-sm {
      max-width: 640px;
      margin: 0 auto;
      padding: 0 var(--spacing-lg);
    }

    /* ============================================
       رأس الصفحة والملاحة - تحسينات شاملة
       ============================================ */

    header {
      background-color: var(--surface);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow-sm);
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(10px);
      background-color: rgba(255, 255, 255, 0.95);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--spacing-md) 0;
    }

    .logo {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .logo:hover {
      color: var(--primary-dark);
      transform: scale(1.05);
    }

    .logo-icon {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1.3rem;
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
    }

    .logo:hover .logo-icon {
      transform: rotate(10deg) scale(1.1);
    }

    nav {
      display: flex;
      gap: var(--spacing-xl);
      align-items: center;
    }

    .main-nav {
      display: flex;
      gap: var(--spacing-xl);
      align-items: center;
    }

    .main-nav a {
      color: var(--text-secondary);
      font-weight: 500;
      transition: all 0.3s ease;
      background: transparent;
      border: none;
      padding: var(--spacing-sm) var(--spacing-md);
      cursor: pointer;
      font-family: inherit;
      font-size: inherit;
      border-radius: var(--radius-md);
      text-decoration: none;
      position: relative;
    }

    .main-nav a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      right: 50%;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: all 0.3s ease;
      transform: translateX(50%);
    }

    .main-nav a:hover {
      color: var(--primary);
      background-color: var(--background);
      transform: translateY(-2px);
    }

    .main-nav a:hover::after {
      width: 80%;
    }

    .main-nav a.active {
      color: var(--primary);
      background-color: var(--background);
      border-bottom: 2px solid var(--accent);
    }

    .main-nav a.active::after {
      width: 80%;
    }

    .mobile-nav-toggle {
      display: none;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      padding: 0.5rem;
      cursor: pointer;
      color: var(--primary);
      transition: all 0.3s ease;
    }

    .mobile-nav-toggle:hover {
      color: var(--primary-dark);
      transform: scale(1.1);
    }

    .lang-toggle {
      background: linear-gradient(135deg, var(--background) 0%, var(--border) 100%);
      border: 1px solid var(--border);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 500;
      color: var(--primary);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .lang-toggle:hover {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* ============================================
       القائمة المتنقلة للجوال
       ============================================ */

    .mobile-menu {
      position: fixed;
      top: 0;
      right: -100%;
      width: 80%;
      max-width: 320px;
      height: 100vh;
      background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
      z-index: 2000;
      transition: right 0.3s ease;
      overflow-y: auto;
    }

    .mobile-menu.active {
      right: 0;
    }

    .mobile-menu-header {
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
    }

    .mobile-menu-close {
      background: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .mobile-menu-close:hover {
      background-color: rgba(255, 255, 255, 0.1);
      transform: rotate(90deg);
    }

    .mobile-menu-content {
      padding: var(--spacing-lg);
    }

    .mobile-menu-content a,
    .mobile-menu-content button {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      width: 100%;
      padding: var(--spacing-md);
      text-align: right;
      color: var(--text-secondary);
      border: none;
      background: transparent;
      cursor: pointer;
      font-family: inherit;
      font-size: inherit;
      border-radius: var(--radius-md);
      margin-bottom: var(--spacing-sm);
      transition: all 0.3s ease;
      text-decoration: none;
      position: relative;
    }

    .mobile-menu-content a::after {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width 0.3s ease;
      transform: translateY(-50%);
    }

    .mobile-menu-content a:hover {
      background: linear-gradient(135deg, var(--background) 0%, var(--border) 100%);
      color: var(--primary);
      transform: translateX(-4px);
    }

    .mobile-menu-content a:hover::after {
      width: 3px;
    }

    .mobile-menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1500;
      display: none;
      backdrop-filter: blur(4px);
    }

    .mobile-menu-overlay.active {
      display: block;
    }

    /* ============================================
       الصفحة الرئيسية - تصميم احترافي
       ============================================ */

    .hero {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 50%, var(--accent) 100%);
      color: white;
      padding: var(--spacing-3xl) 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.05" d="M0,96L48,112C96,128,192,160,288,165.3C384,171,480,149,576,128C672,107,768,85,864,90.7C960,96,1056,128,1152,133.3C1248,139,1344,117,1392,106.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
      background-size: cover;
    }

    .hero::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: float 20s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      33% { transform: translate(-30px, -30px) rotate(120deg); }
      66% { transform: translate(30px, -30px) rotate(240deg); }
    }

    .hero-content {
      position: relative;
      z-index: 1;
      max-width: 800px;
      margin: 0 auto;
    }

    .hero h1 {
      color: white;
      font-size: var(--font-size-5xl);
      margin-bottom: var(--spacing-lg);
      animation: fadeInUp 0.8s ease;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    }

    .hero .subtitle {
      color: rgba(255, 255, 255, 0.95);
      font-size: var(--font-size-xl);
      margin-bottom: var(--spacing-2xl);
      animation: fadeInUp 0.8s ease 0.2s both;
      line-height: 1.8;
    }

    .hero-buttons {
      display: flex;
      gap: var(--spacing-lg);
      justify-content: center;
      flex-wrap: wrap;
      animation: fadeInUp 0.8s ease 0.4s both;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ============================================
       قسم الميزات
       ============================================ */

    .features-section {
      padding: var(--spacing-3xl) 0;
      background: var(--surface);
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--spacing-2xl);
      margin-top: var(--spacing-3xl);
    }

    .feature-card {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--spacing-2xl);
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: all 0.4s ease;
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .feature-card:hover::before {
      transform: scaleX(1);
    }

    .feature-card:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-8px);
    }

    .feature-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--spacing-lg);
      font-size: 2rem;
      color: white;
      box-shadow: 0 8px 20px rgba(11, 61, 145, 0.3);
      transition: all 0.3s ease;
    }

    .feature-card:hover .feature-icon {
      transform: scale(1.1) rotate(5deg);
    }

    .feature-card h3 {
      color: var(--primary);
      margin-bottom: var(--spacing-md);
      font-size: var(--font-size-xl);
    }

    .feature-card p {
      color: var(--text-secondary);
      font-size: var(--font-size-base);
      margin-bottom: var(--spacing-lg);
      line-height: 1.8;
    }

    /* ============================================
       قسم الإحصائيات
       ============================================ */

    .stats-section {
      padding: var(--spacing-3xl) 0;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-xl);
      text-align: center;
    }

    .stat-item {
      padding: var(--spacing-lg);
    }

    .stat-number {
      font-size: var(--font-size-4xl);
      font-weight: 700;
      margin-bottom: var(--spacing-sm);
      background: linear-gradient(135deg, var(--accent) 0%, white 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-label {
      font-size: var(--font-size-lg);
      opacity: 0.9;
    }

    /* ============================================
       قسم CTA
       ============================================ */

    .cta-section {
      padding: var(--spacing-3xl) 0;
      background: var(--background);
      text-align: center;
    }

    .cta-content {
      max-width: 600px;
      margin: 0 auto;
    }

    .cta-content h2 {
      color: var(--primary);
      margin-bottom: var(--spacing-lg);
    }

    /* ============================================
       النماذج والمدخلات
       ============================================ */

    .form-group {
      margin-bottom: var(--spacing-lg);
    }

    label {
      display: block;
      margin-bottom: var(--spacing-sm);
      font-weight: 500;
      color: var(--text-primary);
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="tel"],
    input[type="date"],
    input[type="url"],
    textarea,
    select {
      width: 100%;
      padding: var(--spacing-md);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      transition: all 0.3s ease;
      background-color: var(--surface);
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="password"]:focus,
    input[type="tel"]:focus,
    input[type="date"]:focus,
    input[type="url"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(11, 61, 145, 0.1);
      background-color: white;
    }

    textarea {
      resize: vertical;
      min-height: 120px;
    }

    .form-hint {
      font-size: var(--font-size-sm);
      color: var(--muted);
      margin-top: var(--spacing-xs);
    }

    .form-error {
      color: var(--error);
      font-size: var(--font-size-sm);
      margin-top: var(--spacing-xs);
    }

    .form-success {
      color: var(--success);
      font-size: var(--font-size-sm);
      margin-top: var(--spacing-xs);
    }

    /* ============================================
       التخطيط والشبكات
       ============================================ */

    .grid {
      display: grid;
      gap: var(--spacing-lg);
    }

    .grid-2 {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }

    .grid-3 {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }

    .flex {
      display: flex;
      gap: var(--spacing-md);
    }

    .flex-between {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .flex-center {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ============================================
       الرسائل والتنبيهات
       ============================================ */

    .alert {
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-lg);
      position: relative;
      animation: slideIn 0.3s ease;
      border-right: 4px solid;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .alert-success {
      background-color: #D1FAE5;
      color: #065F46;
      border-right-color: var(--success);
    }

    .alert-error {
      background-color: #FEE2E2;
      color: #7F1D1D;
      border-right-color: var(--error);
    }

    .alert-warning {
      background-color: #FEF3C7;
      color: #78350F;
      border-right-color: var(--warning);
    }

    .alert-info {
      background-color: #DBEAFE;
      color: #0C2340;
      border-right-color: var(--primary);
    }

    .alert-close {
      position: absolute;
      top: var(--spacing-md);
      left: var(--spacing-md);
      background: transparent;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: inherit;
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }

    .alert-close:hover {
      opacity: 1;
    }

    /* ============================================
       الصفحات والأقسام
       ============================================ */

    .page {
      min-height: calc(100vh - 200px);
      padding: var(--spacing-2xl) 0;
    }

    .section {
      padding: var(--spacing-2xl) 0;
    }

    .section-title {
      text-align: center;
      margin-bottom: var(--spacing-2xl);
    }

    .section-title h2 {
      margin-bottom: var(--spacing-md);
      font-size: var(--font-size-3xl);
    }

    .section-title p {
      color: var(--text-secondary);
      font-size: var(--font-size-lg);
      max-width: 600px;
      margin: 0 auto;
    }

    /* ============================================
       التذييل
       ============================================ */

    footer {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: var(--spacing-3xl) 0 var(--spacing-xl);
      margin-top: var(--spacing-3xl);
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
      position: relative;
      transition: all 0.3s ease;
    }

    footer a:hover {
      color: white;
    }

    footer a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      right: 0;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width 0.3s ease;
    }

    footer a:hover::after {
      width: 100%;
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-2xl);
      margin-bottom: var(--spacing-2xl);
    }

    .footer-section h4 {
      color: white;
      margin-bottom: var(--spacing-lg);
      font-size: var(--font-size-xl);
    }

    .footer-section p {
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.8;
    }

    .footer-section ul {
      list-style: none;
    }

    .footer-section li {
      margin-bottom: var(--spacing-sm);
    }

    .footer-section li a {
      color: rgba(255, 255, 255, 0.8);
      transition: all 0.3s ease;
      display: inline-block;
    }

    .footer-section li a:hover {
      color: var(--accent);
      transform: translateX(-4px);
    }

    .social-links {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-lg);
    }

    .social-links a {
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .social-links a:hover {
      background: var(--accent);
      transform: translateY(-4px);
    }

    .footer-bottom {
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      padding-top: var(--spacing-xl);
      text-align: center;
      color: rgba(255, 255, 255, 0.8);
    }

    /* ============================================
       صفحة المُنشئ (Builder)
       ============================================ */

    .builder-layout {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: var(--spacing-xl);
      min-height: calc(100vh - 200px);
    }

    .builder-sidebar {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--spacing-xl);
      box-shadow: var(--shadow-lg);
      height: fit-content;
      position: sticky;
      top: 100px;
      border: 1px solid var(--border);
    }

    .builder-form {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--spacing-2xl);
      box-shadow: var(--shadow-lg);
      border: 1px solid var(--border);
    }

    .builder-preview {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--spacing-2xl);
      box-shadow: var(--shadow-lg);
      margin-top: var(--spacing-xl);
      border: 1px solid var(--border);
    }

    .nav-item {
      padding: var(--spacing-md);
      margin-bottom: var(--spacing-sm);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all 0.3s ease;
      border-right: 3px solid transparent;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .nav-item:hover {
      background: linear-gradient(135deg, var(--background) 0%, var(--border) 100%);
    }

    .nav-item.active {
      background: linear-gradient(135deg, var(--background) 0%, var(--border) 100%);
      color: var(--primary);
      border-right-color: var(--accent);
      font-weight: 600;
    }

    .ats-selector {
      background: linear-gradient(135deg, var(--background) 0%, var(--border) 100%);
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-lg);
    }

    .ats-warning {
      background: #FEF3C7;
      border-right: 4px solid var(--warning);
      padding: var(--spacing-md);
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-lg);
      font-size: var(--font-size-sm);
    }

    /* ============================================
       تصميم السيرة الذاتية - احترافي ومتعدد القوالب
       ============================================ */

    .resume-template {
      background: white;
      padding: var(--spacing-3xl);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      font-size: 0.95rem;
      line-height: 1.8;
      border: 1px solid var(--border);
      max-width: 210mm;
      margin: 0 auto;
      transition: all 0.3s ease;
    }

    /* قالب ATS بسيط */
    .resume-template.ats-simple {
      padding: var(--spacing-xl);
      font-family: 'Times New Roman', serif;
      font-size: 12pt;
    }

    .resume-template.ats-simple .resume-header {
      text-align: left;
      border-bottom: 1px solid #000;
      padding-bottom: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .resume-template.ats-simple .resume-name {
      font-size: 16pt;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 0.5rem;
    }

    .resume-template.ats-simple .resume-contact {
      display: block;
      font-size: 10pt;
      line-height: 1.4;
    }

    .resume-template.ats-simple .contact-item {
      display: inline;
      margin-left: 1rem;
    }

    .resume-template.ats-simple .resume-section-title {
      font-size: 12pt;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: none;
      padding: 0;
      margin-bottom: 0.5rem;
      margin-top: 1rem;
    }

    .resume-template.ats-simple .resume-entry {
      margin-bottom: 0.5rem;
    }

    .resume-template.ats-simple .resume-entry-header {
      display: block;
    }

    .resume-template.ats-simple .resume-entry-title {
      font-weight: bold;
      display: inline;
    }

    .resume-template.ats-simple .resume-entry-date {
      float: left;
      font-style: italic;
    }

    .resume-template.ats-simple .resume-entry-subtitle {
      font-style: italic;
      display: block;
    }

    /* قالب احترافي حديث */
    .resume-template.modern {
      background: linear-gradient(to right, #f8f9fa 0%, #ffffff 100%);
    }

    .resume-template.modern .resume-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: var(--spacing-2xl);
      margin: calc(-1 * var(--spacing-3xl)) calc(-1 * var(--spacing-3xl)) var(--spacing-2xl);
      border-radius: var(--radius-lg) var(--radius-lg) 0 0;
      text-align: center;
    }

    .resume-template.modern .resume-name {
      color: white;
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .resume-template.modern .resume-contact {
      display: flex;
      justify-content: center;
      gap: var(--spacing-lg);
      flex-wrap: wrap;
      margin-top: var(--spacing-md);
    }

    .resume-template.modern .contact-item {
      background: rgba(255, 255, 255, 0.1);
      padding: var(--spacing-xs) var(--spacing-md);
      border-radius: var(--radius-lg);
      backdrop-filter: blur(10px);
    }

    .resume-template.modern .resume-section-title {
      color: var(--primary);
      font-size: 1.5rem;
      border-bottom: 3px solid var(--accent);
      padding-bottom: var(--spacing-sm);
      margin-bottom: var(--spacing-lg);
      position: relative;
    }

    .resume-template.modern .resume-section-title::before {
      content: '';
      position: absolute;
      bottom: -3px;
      right: 0;
      width: 50px;
      height: 3px;
      background: var(--accent);
    }

    /* قالب إبداعي */
    .resume-template.creative {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .resume-template.creative .resume-header {
      text-align: center;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      padding-bottom: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
    }

    .resume-template.creative .resume-name {
      font-size: 3rem;
      font-weight: 300;
      letter-spacing: 3px;
      margin-bottom: var(--spacing-md);
    }

    .resume-template.creative .resume-contact {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-md);
      margin-top: var(--spacing-lg);
    }

    .resume-template.creative .contact-item {
      background: rgba(255, 255, 255, 0.1);
      padding: var(--spacing-sm);
      border-radius: var(--radius-md);
      text-align: center;
      backdrop-filter: blur(10px);
    }

    .resume-template.creative .resume-section-title {
      font-size: 1.8rem;
      font-weight: 300;
      letter-spacing: 2px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.3);
      padding-bottom: var(--spacing-sm);
      margin-bottom: var(--spacing-lg);
    }

    .resume-template.creative .skill-tag {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* قالب تنفيذي */
    .resume-template.executive {
      background: #1a1a1a;
      color: #e0e0e0;
    }

    .resume-template.executive .resume-header {
      border-bottom: 2px solid #c99a6b;
      padding-bottom: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
      text-align: center;
    }

    .resume-template.executive .resume-name {
      color: #c99a6b;
      font-size: 2.2rem;
      font-weight: 300;
      letter-spacing: 2px;
      margin-bottom: var(--spacing-md);
    }

    .resume-template.executive .resume-contact {
      display: flex;
      justify-content: center;
      gap: var(--spacing-xl);
      flex-wrap: wrap;
      margin-top: var(--spacing-md);
    }

    .resume-template.executive .contact-item {
      color: #c99a6b;
      font-weight: 500;
    }

    .resume-template.executive .resume-section-title {
      color: #c99a6b;
      font-size: 1.4rem;
      font-weight: 300;
      letter-spacing: 1px;
      border-bottom: 1px solid #333;
      padding-bottom: var(--spacing-sm);
      margin-bottom: var(--spacing-lg);
    }

    .resume-template.executive .resume-entry-title {
      color: #ffffff;
    }

    .resume-template.executive .skill-tag {
      background: #333;
      color: #c99a6b;
      border: 1px solid #c99a6b;
    }

    /* العناصر المشتركة */
    .resume-header {
      margin-bottom: var(--spacing-xl);
      position: relative;
    }

    .resume-name {
      font-weight: 700;
      margin-bottom: var(--spacing-md);
    }

    .resume-contact {
      margin-top: var(--spacing-md);
    }

    .contact-item {
      display: block;
      margin-bottom: var(--spacing-xs);
    }

    .resume-section {
      margin-bottom: var(--spacing-xl);
      page-break-inside: avoid;
    }

    .resume-section-title {
      font-weight: 700;
      margin-bottom: var(--spacing-lg);
      position: relative;
    }

    .resume-entry {
      margin-bottom: var(--spacing-lg);
      page-break-inside: avoid;
    }

    .resume-entry:last-child {
      margin-bottom: 0;
    }

    .resume-entry-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--spacing-sm);
      flex-wrap: wrap;
      gap: var(--spacing-sm);
    }

    .resume-entry-title {
      font-weight: 600;
      font-size: 1.1rem;
    }

    .resume-entry-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-sm);
      font-weight: 500;
    }

    .resume-entry-date {
      font-size: var(--font-size-sm);
      font-weight: 500;
      white-space: nowrap;
    }

    .resume-entry-description {
      margin-top: var(--spacing-sm);
      font-size: var(--font-size-sm);
      line-height: 1.7;
      text-align: justify;
    }

    .resume-skills {
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-sm);
      margin-top: var(--spacing-md);
    }

    .skill-tag {
      padding: var(--spacing-xs) var(--spacing-md);
      border-radius: var(--radius-lg);
      font-size: var(--font-size-sm);
      font-weight: 500;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
    }

    .skill-tag:hover {
      transform: translateY(-2px);
    }

    .resume-text-view {
      background: #F3F4F6;
      padding: var(--spacing-xl);
      border-radius: var(--radius-lg);
      font-family: 'Courier New', monospace;
      font-size: var(--font-size-sm);
      white-space: pre-wrap;
      word-wrap: break-word;
      line-height: 1.8;
    }

    /* ============================================
       قالب المعاينة (Templates)
       ============================================ */

    .template-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: var(--spacing-2xl);
      margin: var(--spacing-2xl) 0;
    }

    .template-card {
      background: var(--surface);
      border-radius: var(--radius-2xl);
      overflow: hidden;
      box-shadow: var(--shadow-md);
      transition: all 0.4s ease;
      cursor: pointer;
      border: 1px solid var(--border);
    }

    .template-card:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-8px);
    }

    .template-preview {
      width: 100%;
      height: 220px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 1.3rem;
      position: relative;
      overflow: hidden;
    }

    .template-preview::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: float 15s ease-in-out infinite;
    }

    .template-info {
      padding: var(--spacing-xl);
    }

    .template-info h3 {
      margin-bottom: var(--spacing-sm);
      color: var(--primary);
    }

    .template-badge {
      display: inline-block;
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-lg);
      font-size: var(--font-size-xs);
      font-weight: 600;
      margin-bottom: var(--spacing-md);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .template-badge.ats-friendly {
      background: #D1FAE5;
      color: #065F46;
    }

    .template-badge.not-ats-friendly {
      background: #FEE2E2;
      color: #7F1D1D;
    }

    /* ============================================
       صفحة المصادقة (Auth) - محسّنة
       ============================================ */

    .auth-container {
      max-width: 1000px;
      margin: var(--spacing-2xl) auto;
      padding: var(--spacing-lg);
    }

    .auth-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      background: var(--surface);
      border-radius: var(--radius-2xl);
      overflow: hidden;
      box-shadow: var(--shadow-xl);
    }

    .auth-info {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: var(--spacing-3xl);
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .auth-info::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
      animation: float 20s ease-in-out infinite;
    }

    .auth-info h2 {
      color: white;
      font-size: var(--font-size-3xl);
      margin-bottom: var(--spacing-lg);
      position: relative;
      z-index: 1;
    }

    .auth-info p {
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: var(--spacing-xl);
      line-height: 1.8;
      position: relative;
      z-index: 1;
    }

    .auth-form {
      padding: var(--spacing-3xl);
    }

    .auth-tabs {
      display: flex;
      margin-bottom: var(--spacing-2xl);
      border-bottom: 2px solid var(--border);
    }

    .auth-tab {
      padding: var(--spacing-md) var(--spacing-lg);
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
      transition: all 0.3s ease;
    }

    .auth-tab.active {
      color: var(--primary);
      border-bottom-color: var(--accent);
    }

    .auth-card {
      max-width: 100%;
    }

    .auth-card h2 {
      text-align: center;
      margin-bottom: var(--spacing-2xl);
      color: var(--primary);
    }

    .auth-divider {
      text-align: center;
      margin: var(--spacing-xl) 0;
      color: var(--text-secondary);
      position: relative;
    }

    .auth-divider::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background-color: var(--border);
    }

    .auth-divider span {
      background-color: var(--surface);
      padding: 0 var(--spacing-md);
      position: relative;
    }

    .social-login {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .social-btn {
      padding: var(--spacing-md);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      background: var(--surface);
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
    }

    .social-btn:hover {
      background: var(--background);
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .auth-link {
      text-align: center;
      margin-top: var(--spacing-lg);
      font-size: var(--font-size-sm);
    }

    .auth-link a {
      color: var(--primary);
      font-weight: 600;
      text-decoration: none;
      position: relative;
    }

    .auth-link a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      right: 0;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width 0.3s ease;
    }

    .auth-link a:hover::after {
      width: 100%;
    }

    .auth-terms {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      text-align: center;
      margin-top: var(--spacing-md);
    }

    .auth-terms a {
      color: var(--primary);
      text-decoration: underline;
    }

    /* ============================================
       صفحة تواصل معنا
       ============================================ */

    .contact-container {
      max-width: 1000px;
      margin: 0 auto;
      padding: var(--spacing-lg);
    }

    .contact-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-2xl);
      background: var(--surface);
      border-radius: var(--radius-2xl);
      padding: var(--spacing-3xl);
      box-shadow: var(--shadow-xl);
    }

    .contact-info {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .contact-info h2 {
      color: var(--primary);
      margin-bottom: var(--spacing-lg);
      font-size: var(--font-size-3xl);
    }

    .contact-info p {
      color: var(--text-secondary);
      margin-bottom: var(--spacing-xl);
      line-height: 1.8;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-xl);
    }

    .contact-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.3rem;
      box-shadow: 0 4px 15px rgba(11, 61, 145, 0.3);
      transition: all 0.3s ease;
    }

    .contact-item:hover .contact-icon {
      transform: scale(1.1) rotate(5deg);
    }

    .contact-details h4 {
      color: var(--primary);
      margin-bottom: var(--spacing-xs);
      font-size: var(--font-size-lg);
    }

    .contact-details p {
      color: var(--text-secondary);
      margin: 0;
      font-size: var(--font-size-base);
    }

    .contact-form {
      display: flex;
      flex-direction: column;
    }

    .contact-form h3 {
      color: var(--primary);
      margin-bottom: var(--spacing-xl);
      font-size: var(--font-size-2xl);
    }

    /* ============================================
       لوحة التحكم (Dashboard)
       ============================================ */

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: var(--spacing-2xl);
      margin: var(--spacing-2xl) 0;
    }

    .resume-item {
      background: var(--surface);
      border-radius: var(--radius-xl);
      padding: var(--spacing-xl);
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      border: 1px solid var(--border);
    }

    .resume-item:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-4px);
    }

    .resume-item-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: var(--spacing-md);
    }

    .resume-item-title {
      font-weight: 600;
      color: var(--primary);
      font-size: var(--font-size-lg);
    }

    .resume-item-date {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }

    .resume-item-actions {
      display: flex;
      gap: var(--spacing-sm);
      margin-top: var(--spacing-lg);
    }

    .resume-item-actions button {
      flex: 1;
      padding: var(--spacing-sm) var(--spacing-md);
      font-size: var(--font-size-sm);
    }

    /* ============================================
       مؤشر التحميل
       ============================================ */

    .loading-indicator {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
      display: none;
    }

    .loading-indicator.active {
      display: block;
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--border);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ============================================
       الاستجابة والشاشات الصغيرة
       ============================================ */

    @media (max-width: 1024px) {
      .builder-layout {
        grid-template-columns: 1fr;
      }
      
      .builder-sidebar {
        position: relative;
        top: 0;
        height: auto;
      }

      .auth-wrapper {
        grid-template-columns: 1fr;
      }

      .contact-wrapper {
        grid-template-columns: 1fr;
      }

      .hero h1 {
        font-size: var(--font-size-4xl);
      }
    }

    @media (max-width: 768px) {
      .header-content {
        padding: var(--spacing-md) 0;
      }

      .main-nav {
        display: none;
      }

      .mobile-nav-toggle {
        display: block;
      }

      .hero {
        padding: var(--spacing-2xl) 0;
      }

      .hero h1 {
        font-size: var(--font-size-3xl);
      }

      .hero .subtitle {
        font-size: var(--font-size-lg);
      }

      .features-grid {
        grid-template-columns: 1fr;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .grid-2 {
        grid-template-columns: 1fr;
      }

      .grid-3 {
        grid-template-columns: 1fr;
      }

      .template-grid {
        grid-template-columns: 1fr;
      }

      .social-login {
        grid-template-columns: 1fr;
      }

      .footer-content {
        grid-template-columns: 1fr;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .hero-buttons .btn {
        width: 100%;
        max-width: 300px;
      }

      .section-title h2 {
        font-size: var(--font-size-2xl);
      }

      .resume-template {
        padding: var(--spacing-lg);
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 0 var(--spacing-md);
      }

      h1 { font-size: var(--font-size-2xl); }
      h2 { font-size: var(--font-size-xl); }
      h3 { font-size: var(--font-size-lg); }

      .btn {
        width: 100%;
      }

      .card {
        padding: var(--spacing-lg);
      }

      .hero {
        padding: var(--spacing-xl) 0;
      }

      .section {
        padding: var(--spacing-xl) 0;
      }

      .auth-form {
        padding: var(--spacing-lg);
      }

      .contact-wrapper {
        padding: var(--spacing-lg);
      }

      .mobile-menu {
        width: 90%;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .resume-template {
        padding: var(--spacing-md);
      }

      .resume-template.ats-simple {
        font-size: 10pt;
      }

      .resume-template.modern .resume-name {
        font-size: 1.8rem;
      }

      .resume-template.creative .resume-name {
        font-size: 2rem;
      }
    }

    /* ============================================
       الطباعة والتصدير - تحسينات خاصة بـ PDF
       ============================================ */

    @media print {
      body {
        background-color: white;
        font-size: 12pt;
      }

      header, footer, nav, .btn, .alert, .no-print {
        display: none !important;
      }

      .resume-template {
        box-shadow: none;
        padding: 20mm;
        border: none;
        margin: 0;
        max-width: 100%;
        page-break-after: always;
      }

      .resume-template:last-child {
        page-break-after: auto;
      }

      /* تحسينات للطباعة ATS */
      .resume-template.ats-simple {
        padding: 15mm;
        font-size: 11pt;
        line-height: 1.4;
      }

      .resume-template.ats-simple .resume-contact {
        display: block;
        margin-bottom: 1rem;
      }

      .resume-template.ats-simple .contact-item {
        display: block;
        margin-bottom: 0.3rem;
        background: transparent !important;
        border: none !important;
        padding: 0 !important;
      }

      /* تحسينات للطباعة الحديثة */
      .resume-template.modern {
        background: white !important;
      }

      .resume-template.modern .resume-header {
        background: #f8f9fa !important;
        color: #333 !important;
        border-bottom: 2px solid #dee2e6 !important;
      }

      .resume-template.modern .resume-name {
        color: #333 !important;
        text-shadow: none !important;
      }

      .resume-template.modern .contact-item {
        background: #f8f9fa !important;
        color: #333 !important;
        border: 1px solid #dee2e6 !important;
      }

      /* تحسينات للطباعة الإبداعية */
      .resume-template.creative {
        background: white !important;
        color: #333 !important;
      }

      .resume-template.creative .resume-header {
        border-bottom: 2px solid #dee2e6 !important;
      }

      .resume-template.creative .resume-name {
        color: #333 !important;
      }

      .resume-template.creative .contact-item {
        background: #f8f9fa !important;
        color: #333 !important;
        border: 1px solid #dee2e6 !important;
      }

      /* تحسينات للطباعة التنفيذية */
      .resume-template.executive {
        background: white !important;
        color: #333 !important;
      }

      .resume-template.executive .resume-name {
        color: #333 !important;
      }

      .resume-template.executive .contact-item {
        color: #333 !important;
      }

      .resume-template.executive .resume-entry-title {
        color: #333 !important;
      }

      .resume-template.executive .skill-tag {
        background: #f8f9fa !important;
        color: #333 !important;
        border: 1px solid #dee2e6 !important;
      }

      .resume-section {
        margin-bottom: 15mm;
        page-break-inside: avoid;
      }

      .resume-entry {
        margin-bottom: 10mm;
        page-break-inside: avoid;
      }

      .resume-entry-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 2mm;
      }

      .resume-skills {
        display: flex;
        flex-wrap: wrap;
        gap: 5mm;
      }

      .skill-tag {
        background: #f8f9fa !important;
        color: #333 !important;
        border: 1px solid #dee2e6 !important;
        padding: 2mm 5mm;
      }
    }

    @page {
      size: A4;
      margin: 15mm;
    }

    /* ============================================
       تحسينات إضافية
       ============================================ */

    #app {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #app-content {
      flex: 1;
    }

    /* تحسينات للوصولية */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* تحسينات للتركيز */
    *:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    button:focus,
    input:focus,
    textarea:focus,
    select:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* تحسينات للتصدير */
    .pdf-export .resume-contact {
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      gap: 4px !important;
    }

    .pdf-export .contact-item {
      display: block !important;
      text-align: center !important;
      margin-bottom: 2px !important;
      background: #f5f5f5 !important;
      border: 1px solid #ddd !important;
      padding: 4px 8px !important;
      border-radius: 4px !important;
    }

    /* تحريك العناصر */
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* تحسينات للجوال */
    @media (max-width: 768px) {
      .builder-layout {
        grid-template-columns: 1fr !important;
      }

      .builder-content {
        display: flex;
        flex-direction: column;
      }

      .builder-preview {
        order: -1;
      }

      .mobile-menu {
        width: 85%;
        max-width: 300px;
      }
    }

    /* ============================================
       تحسينات خاصة بـ ATS
       ============================================ */

    .ats-compatibility-indicator {
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-xs);
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-md);
      font-size: var(--font-size-xs);
      font-weight: 600;
      margin-left: var(--spacing-sm);
    }

    .ats-compatibility-indicator.high {
      background: #D1FAE5;
      color: #065F46;
    }

    .ats-compatibility-indicator.medium {
      background: #FEF3C7;
      color: #78350F;
    }

    .ats-compatibility-indicator.low {
      background: #FEE2E2;
      color: #7F1D1D;
    }

    .ats-recommendations {
      background: #F3F4F6;
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-md);
      margin-top: var(--spacing-md);
    }

    .ats-recommendations h4 {
      color: var(--primary);
      margin-bottom: var(--spacing-sm);
      font-size: var(--font-size-sm);
    }

    .ats-recommendations ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .ats-recommendations li {
      padding: var(--spacing-xs) 0;
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-xs);
    }

    .ats-recommendations li::before {
      content: '•';
      color: var(--accent);
      font-weight: bold;
      margin-right: var(--spacing-xs);
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- سيتم ملؤه بواسطة JavaScript -->
  </div>

  <!-- القائمة المتنقلة للجوال -->
  <div class="mobile-menu-overlay" onclick="closeMobileMenu()"></div>
  <div class="mobile-menu">
    <div class="mobile-menu-header">
      <div class="logo">
        <div class="logo-icon">CV</div>
        <span>CV Studio</span>
      </div>
      <button class="mobile-menu-close" onclick="closeMobileMenu()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="mobile-menu-content">
      <!-- سيتم ملؤه بواسطة JavaScript -->
    </div>
  </div>

  <!-- مؤشر التحميل -->
  <div class="loading-indicator" id="loading-indicator">
    <div class="spinner"></div>
  </div>

  <!-- مكتبات خارجية -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- التطبيق الرئيسي -->
  <script>
    /* ============================================
       CV Studio - منطق التطبيق الرئيسي
       ============================================ */

    // ============ إدارة الحالة والبيانات ============

    const AppState = {
      currentPage: 'home',
      currentLanguage: 'ar',
      selectedATS: 'generic',
      currentTemplate: 'modern',
      authMode: 'login',
      resumeData: {
        personalInfo: {
          fullName: '',
          email: '',
          phone: '',
          location: '',
          website: '',
          summary: ''
        },
        experience: [],
        education: [],
        skills: [],
        certifications: [],
        projects: [],
        photo: null
      },
      userAuth: {
        isLoggedIn: false,
        username: '',
        savedResumes: []
      }
    };

    // قاموس الترجمات
    const Translations = {
      ar: {
        appTitle: 'CV Studio',
        appSubtitle: 'محرر السير الذاتية الاحترافي',
        home: 'الرئيسية',
        builder: 'المُنشئ',
        templates: 'القوالب',
        dashboard: 'لوحة التحكم',
        login: 'دخول',
        logout: 'خروج',
        signup: 'إنشاء حساب',
        startNow: 'ابدأ الآن',
        createProfessional: 'إنشاء سيرة احترافية',
        atsPreview: 'معاينة ATS',
        quickTemplates: 'قوالب سريعة',
        support: 'الدعم',
        contact: 'تواصل معنا',
        personalInfo: 'المعلومات الشخصية',
        experience: 'الخبرة العملية',
        education: 'التعليم',
        skills: 'المهارات',
        certifications: 'الشهادات',
        projects: 'المشاريع',
        selectATS: 'اختر نظام التوظيف',
        selectTemplate: 'اختر القالب',
        genericATS: 'عام (Generic ATS)',
        workday: 'Workday',
        oracle: 'Oracle/Taleo',
        greenhouse: 'Greenhouse',
        icims: 'iCIMS',
        lever: 'Lever',
        smartrecruiters: 'SmartRecruiters',
        bamboohr: 'BambooHR',
        fullName: 'الاسم الكامل',
        email: 'البريد الإلكتروني',
        phone: 'رقم الهاتف',
        location: 'المدينة/الدولة',
        website: 'موقع ويب',
        summary: 'ملخص مهني',
        jobTitle: 'المسمى الوظيفي',
        company: 'الشركة',
        startDate: 'تاريخ البداية',
        endDate: 'تاريخ النهاية',
        description: 'الوصف',
        institution: 'المؤسسة',
        degree: 'الدرجة العلمية',
        field: 'التخصص',
        graduationDate: 'تاريخ التخرج',
        skillName: 'اسم المهارة',
        proficiency: 'مستوى الكفاءة',
        certificateName: 'اسم الشهادة',
        issuer: 'الجهة المصدرة',
        issueDate: 'تاريخ الإصدار',
        projectName: 'اسم المشروع',
        projectLink: 'رابط المشروع',
        saveDraft: 'حفظ كمسودة',
        exportPDF: 'تصدير PDF',
        exportDOCX: 'تصدير DOCX',
        preview: 'معاينة',
        edit: 'تعديل',
        delete: 'حذف',
        add: 'إضافة',
        cancel: 'إلغاء',
        save: 'حفظ',
        loading: 'جاري التحميل...',
        success: 'تم بنجاح',
        error: 'خطأ',
        warning: 'تحذير',
        photoWarning: 'بعض أنظمة التتبع قد لا تقرأ المعلومات داخل الصور — نوصي بعدم وضع معلومات هامة في الصورة.',
        atsNotSupportsPhoto: 'هذا النظام لا يوصي باستخدام الصور في السيرة الذاتية.',
        noPhotoRecommended: 'لا يُنصح بإضافة صورة لهذا النظام',
        templateModern: 'قالب حديث',
        templateCreative: 'قالب إبداعي',
        templateMinimal: 'قالب بسيط',
        templateExecutive: 'قالب تنفيذي',
        templateAtsSimple: 'قالب ATS بسيط',
        atsFriendly: 'متوافق مع ATS',
        notAtsFriendly: 'غير متوافق مع ATS',
        viewAsText: 'عرض كنص',
        viewAsFormatted: 'عرض مُنسق',
        includePhoto: 'تضمين الصورة في PDF',
        password: 'كلمة المرور',
        confirmPassword: 'تأكيد كلمة المرور',
        forgotPassword: 'نسيت كلمة المرور؟',
        rememberMe: 'تذكرني',
        signupWithGoogle: 'التسجيل عبر Google',
        loginWithGoogle: 'الدخول عبر Google',
        signupWithFacebook: 'التسجيل عبر Facebook',
        loginWithFacebook: 'الدخول عبر Facebook',
        dontHaveAccount: 'ليس لديك حساب؟',
        alreadyHaveAccount: 'هل لديك حساب بالفعل؟',
        myResumes: 'سيري الذاتية',
        newResume: 'سيرة جديدة',
        lastModified: 'آخر تعديل',
        actions: 'الجراءات',
        footerDescription: 'منصة احترافية لإنشاء السير الذاتية المتوافقة مع أنظمة التوظيف',
        footerLinks: 'الروابط',
        footerContact: 'التواصل',
        footerFAQ: 'الأسئلة الشائعة',
        footerTwitter: 'تويتر',
        footerLinkedIn: 'لينكدإن',
        footerCopyright: 'جميع الحقوق محفوظة',
        welcomeBack: 'مرحباً بعودتك',
        createAccount: 'إنشاء حساب جديد',
        loginDesc: 'سجل دخولك للوصول إلى حسابك',
        signupDesc: 'أنشئ حساباً جديداً للبدء في استخدام الخدمة',
        termsAgree: 'بإنشاء حسابك، أنت توافق على',
        termsOfService: 'شروط الخدمة',
        and: 'و',
        privacyPolicy: 'سياسة الخصوصية',
        contactTitle: 'تواصل معنا',
        contactSubtitle: 'نحن هنا لمساعدتك',
        contactName: 'الاسم الكامل',
        contactSubject: 'الموضوع',
        contactMessage: 'الرسالة',
        contactSend: 'إرسال الرسالة',
        contactEmail: 'البريد الإلكتروني',
        contactPhone: 'رقم الهاتف',
        contactAddress: 'العنوان',
        contactHours: 'ساعات العمل',
        heroTitle: 'احترف سيرتك الذاتية',
        heroSubtitle: 'أنشئ سيرة ذاتية احترافية ومتوافقة مع أنظمة التوظيف في دقائق',
        heroFeature1: 'قوالب احترافية',
        heroFeature2: 'متوافق مع ATS',
        heroFeature3: 'تصدير سهل',
        feature1Title: 'قوالب احترافية',
        feature1Desc: 'اختر من بين مجموعة واسعة من القوالب المصممة بعناية',
        feature2Title: 'متوافق مع ATS',
        feature2Desc: 'تأكد من أن سيرتك الذاتية ستمر عبر أنظمة التتبع بنجاح',
        feature3Title: 'تصدير سهل',
        feature3Desc: 'صدّر سيرتك الذاتية بصيغة PDF أو DOCX بنقرة واحدة',
        feature4Title: 'معاينة مباشرة',
        feature4Desc: 'شاهد كيف سيبدو شكل سيرتك الذاتية أثناء الكتابة',
        stats1: '50,000+',
        stats1Label: 'سيرة ذاتية منشأة',
        stats2: '100+',
        stats2Label: 'قالب احترافي',
        stats3: '95%',
        stats3Label: 'معدل القبول',
        stats4: '24/7',
        stats4Label: 'دعم فني',
        ctaTitle: 'جاهز للبدء؟',
        ctaSubtitle: 'انضم إلى آلاف المحترفين الذين استفادوا من خدمتنا',
        atsCompatibilityHigh: 'توافق عالي',
        atsCompatibilityMedium: 'توافق متوسط',
        atsCompatibilityLow: 'توافق منخفض',
        atsRecommendations: 'توصيات ATS',
        atsRecommendation1: 'استخدم كلمات مفتاحية من الوصف الوظيفي',
        atsRecommendation2: 'تجنب الجداول والأعمدة المعقدة',
        atsRecommendation3: 'استخدم تنسيق بسيط وواضح',
        atsRecommendation4: 'تجنب الصور والرموز',
        atsRecommendation5: 'استخدم خطوط قياسية مثل Arial أو Times New Roman'
      },
      en: {
        appTitle: 'CV Studio',
        appSubtitle: 'Professional Resume Builder',
        home: 'Home',
        builder: 'Builder',
        templates: 'Templates',
        dashboard: 'Dashboard',
        login: 'Login',
        logout: 'Logout',
        signup: 'Sign Up',
        startNow: 'Start Now',
        createProfessional: 'Create Professional Resume',
        atsPreview: 'ATS Preview',
        quickTemplates: 'Quick Templates',
        support: 'Support',
        contact: 'Contact Us',
        personalInfo: 'Personal Information',
        experience: 'Work Experience',
        education: 'Education',
        skills: 'Skills',
        certifications: 'Certifications',
        projects: 'Projects',
        selectATS: 'Select ATS System',
        selectTemplate: 'Select Template',
        genericATS: 'Generic ATS',
        workday: 'Workday',
        oracle: 'Oracle/Taleo',
        greenhouse: 'Greenhouse',
        icims: 'iCIMS',
        lever: 'Lever',
        smartrecruiters: 'SmartRecruiters',
        bamboohr: 'BambooHR',
        fullName: 'Full Name',
        email: 'Email',
        phone: 'Phone',
        location: 'City/Country',
        website: 'Website',
        summary: 'Professional Summary',
        jobTitle: 'Job Title',
        company: 'Company',
        startDate: 'Start Date',
        endDate: 'End Date',
        description: 'Description',
        institution: 'Institution',
        degree: 'Degree',
        field: 'Field of Study',
        graduationDate: 'Graduation Date',
        skillName: 'Skill Name',
        proficiency: 'Proficiency Level',
        certificateName: 'Certificate Name',
        issuer: 'Issuer',
        issueDate: 'Issue Date',
        projectName: 'Project Name',
        projectLink: 'Project Link',
        saveDraft: 'Save Draft',
        exportPDF: 'Export PDF',
        exportDOCX: 'Export DOCX',
        preview: 'Preview',
        edit: 'Edit',
        delete: 'Delete',
        add: 'Add',
        cancel: 'Cancel',
        save: 'Save',
        loading: 'Loading...',
        success: 'Success',
        error: 'Error',
        warning: 'Warning',
        photoWarning: 'Some ATS systems may not read information inside images — we recommend not placing important information in the photo.',
        atsNotSupportsPhoto: 'This system does not recommend using photos in the resume.',
        noPhotoRecommended: 'Adding a photo is not recommended for this system',
        templateModern: 'Modern Template',
        templateCreative: 'Creative Template',
        templateMinimal: 'Minimal Template',
        templateExecutive: 'Executive Template',
        templateAtsSimple: 'Simple ATS Template',
        atsFriendly: 'ATS Friendly',
        notAtsFriendly: 'Not ATS Friendly',
        viewAsText: 'View as Text',
        viewAsFormatted: 'View Formatted',
        includePhoto: 'Include Photo in PDF',
        password: 'Password',
        confirmPassword: 'Confirm Password',
        forgotPassword: 'Forgot Password?',
        rememberMe: 'Remember Me',
        signupWithGoogle: 'Sign Up with Google',
        loginWithGoogle: 'Login with Google',
        signupWithFacebook: 'Sign Up with Facebook',
        loginWithFacebook: 'Login with Facebook',
        dontHaveAccount: "Don't have an account?",
        alreadyHaveAccount: 'Already have an account?',
        myResumes: 'My Resumes',
        newResume: 'New Resume',
        lastModified: 'Last Modified',
        actions: 'Actions',
        footerDescription: 'Professional platform for creating ATS-compatible resumes',
        footerLinks: 'Links',
        footerContact: 'Contact',
        footerFAQ: 'FAQ',
        footerTwitter: 'Twitter',
        footerLinkedIn: 'LinkedIn',
        footerCopyright: 'All rights reserved',
        welcomeBack: 'Welcome Back',
        createAccount: 'Create Account',
        loginDesc: 'Sign in to access your account',
        signupDesc: 'Create a new account to get started',
        termsAgree: 'By creating an account, you agree to our',
        termsOfService: 'Terms of Service',
        and: 'and',
        privacyPolicy: 'Privacy Policy',
        contactTitle: 'Contact Us',
        contactSubtitle: 'We are here to help you',
        contactName: 'Full Name',
        contactSubject: 'Subject',
        contactMessage: 'Message',
        contactSend: 'Send Message',
        contactEmail: 'Email',
        contactPhone: 'Phone',
        contactAddress: 'Address',
        contactHours: 'Working Hours',
        heroTitle: 'Master Your Resume',
        heroSubtitle: 'Create a professional, ATS-compatible resume in minutes',
        heroFeature1: 'Professional Templates',
        heroFeature2: 'ATS Compatible',
        heroFeature3: 'Easy Export',
        feature1Title: 'Professional Templates',
        feature1Desc: 'Choose from a wide range of carefully designed templates',
        feature2Title: 'ATS Compatible',
        feature2Desc: 'Ensure your resume passes through tracking systems successfully',
        feature3Title: 'Easy Export',
        feature3Desc: 'Export your resume as PDF or DOCX with one click',
        feature4Title: 'Live Preview',
        feature4Desc: 'See how your resume looks as you write',
        stats1: '50,000+',
        stats1Label: 'Resumes Created',
        stats2: '100+',
        stats2Label: 'Professional Templates',
        stats3: '95%',
        stats3Label: 'Acceptance Rate',
        stats4: '24/7',
        stats4Label: 'Support',
        ctaTitle: 'Ready to Start?',
        ctaSubtitle: 'Join thousands of professionals who have benefited from our service',
        atsCompatibilityHigh: 'High Compatibility',
        atsCompatibilityMedium: 'Medium Compatibility',
        atsCompatibilityLow: 'Low Compatibility',
        atsRecommendations: 'ATS Recommendations',
        atsRecommendation1: 'Use keywords from the job description',
        atsRecommendation2: 'Avoid complex tables and columns',
        atsRecommendation3: 'Use simple and clear formatting',
        atsRecommendation4: 'Avoid images and icons',
        atsRecommendation5: 'Use standard fonts like Arial or Times New Roman'
      }
    };

    // ============ دوال المساعدة ============

    function t(key) {
      const lang = AppState.currentLanguage;
      return Translations[lang]?.[key] || key;
    }

    function escapeHTML(str) {
      if (str === null || str === undefined) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    function setLanguage(lang) {
      AppState.currentLanguage = lang;
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      localStorage.setItem('cv-studio-lang', lang);
      
      // تحديث الصفحة بالكامل مع اللغة الجديدة
      renderPage();
      
      // إظهار إشعار التغيير
      showNotification(
        lang === 'ar' ? 'تم تغيير اللغة إلى العربية' : 'Language changed to English',
        'success'
      );
    }

    function navigateTo(page) {
      AppState.currentPage = page;
      renderPage();
      window.scrollTo(0, 0);
    }

    function saveToLocalStorage() {
      localStorage.setItem('cv-studio-data', JSON.stringify(AppState.resumeData));
      localStorage.setItem('cv-studio-auth', JSON.stringify(AppState.userAuth));
    }

    function loadFromLocalStorage() {
      const savedData = localStorage.getItem('cv-studio-data');
      const savedAuth = localStorage.getItem('cv-studio-auth');
      const savedLang = localStorage.getItem('cv-studio-lang');
      
      if (savedData) {
        AppState.resumeData = JSON.parse(savedData);
      }
      if (savedAuth) {
        AppState.userAuth = JSON.parse(savedAuth);
      }
      if (savedLang) {
        AppState.currentLanguage = savedLang;
        document.documentElement.lang = savedLang;
        document.documentElement.dir = savedLang === 'ar' ? 'rtl' : 'ltr';
      }
    }

    // ============ نظام الإشعارات ============

    function showNotification(message, type = 'info', duration = 3000) {
      const notification = document.createElement('div');
      notification.className = `alert alert-${type}`;
      notification.innerHTML = `
        ${message}
        <button class="alert-close" onclick="this.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentElement) {
          notification.remove();
        }
      }, duration);
    }

    function showLoadingIndicator(show) {
      const loader = document.getElementById('loading-indicator');
      if (loader) {
        loader.classList.toggle('active', show);
      }
    }

    // ============ وظائف ATS المحسّنة ============

    const ATSSystems = {
      generic: {
        name: 'Generic ATS',
        description: 'نظام عام يدعم معظم الميزات',
        supportsPhotos: true,
        supportedFormats: ['PDF', 'DOCX', 'TXT'],
        compatibility: 'high',
        recommendations: ['استخدم تنسيق بسيط وواضح', 'تجنب الجداول المعقدة'],
        bestTemplate: 'modern'
      },
      workday: {
        name: 'Workday',
        description: 'نظام Workday للموارد البشرية',
        supportsPhotos: false,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'medium',
        recommendations: ['تجنب الصور والجداول المعقدة', 'استخدم تنسيق بسيط', 'تجنب الأعمدة المتعددة'],
        bestTemplate: 'ats-simple'
      },
      oracle: {
        name: 'Oracle/Taleo',
        description: 'نظام Oracle Taleo',
        supportsPhotos: false,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'medium',
        recommendations: ['تجنب الصور', 'استخدم الخطوط القياسية', 'تجنب الرموز'],
        bestTemplate: 'ats-simple'
      },
      greenhouse: {
        name: 'Greenhouse',
        description: 'نظام Greenhouse للتوظيف',
        supportsPhotos: true,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'high',
        recommendations: ['يمكن استخدام التصميمات الحديثة'],
        bestTemplate: 'modern'
      },
      icims: {
        name: 'iCIMS',
        description: 'نظام iCIMS',
        supportsPhotos: false,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'low',
        recommendations: ['تجنب الصور والعناصر المرئية المعقدة', 'استخدم تنسيق نصي بحت'],
        bestTemplate: 'ats-simple'
      },
      lever: {
        name: 'Lever',
        description: 'نظام Lever للتوظيف',
        supportsPhotos: true,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'high',
        recommendations: ['يدعم التصاميم الإبداعية'],
        bestTemplate: 'creative'
      },
      smartrecruiters: {
        name: 'SmartRecruiters',
        description: 'نظام SmartRecruiters',
        supportsPhotos: true,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'high',
        recommendations: ['يدعم القوالب الحديثة'],
        bestTemplate: 'modern'
      },
      bamboohr: {
        name: 'BambooHR',
        description: 'نظام BambooHR',
        supportsPhotos: true,
        supportedFormats: ['PDF', 'DOCX'],
        compatibility: 'medium',
        recommendations: ['تجنب التصاميم المعقدة جداً'],
        bestTemplate: 'modern'
      }
    };

    // ============ قوالب السيرة الذاتية المحسّنة ============

    const ResumeTemplates = {
      modern: {
        name: 'Modern Template',
        atsFriendly: true,
        description: 'قالب حديث ومتوازن',
        compatibility: 'high',
        features: ['تصميم عصري', 'ألوان احترافية', 'مناسب لمعظم الوظائف']
      },
      creative: {
        name: 'Creative Template',
        atsFriendly: false,
        description: 'قالب إبداعي مع عناصر بصرية',
        compatibility: 'low',
        features: ['تصميم إبداعي', 'ألوان جريئة', 'مناسب للوظائف الإبداعية']
      },
      minimal: {
        name: 'Minimal Template',
        atsFriendly: true,
        description: 'قالب بسيط وأنظف',
        compatibility: 'high',
        features: ['تصميم بسيط', 'تركيز على المحتوى', 'مثالي للوظائف التقليدية']
      },
      executive: {
        name: 'Executive Template',
        atsFriendly: true,
        description: 'قالب احترافي للمديرين التنفيذيين',
        compatibility: 'high',
        features: ['تصميم فاخر', 'ألوان داكنة', 'مناسب للمناصب العليا']
      },
      'ats-simple': {
        name: 'Simple ATS Template',
        atsFriendly: true,
        description: 'قالب بسيط متوافق مع جميع أنظمة ATS',
        compatibility: 'high',
        features: ['تنسيق نصي بحت', 'متوافق مع جميع الأنظمة', 'أفضل للتوظيف الآلي']
      }
    };

    // ============ بيانات افتراضية محسّنة ============

    const SampleData = {
      personalInfo: {
        fullName: 'أحمد محمد علي',
        email: 'ahmed@example.com',
        phone: '+966 50 123 4567',
        location: 'الرياض، السعودية',
        website: 'https://example.com',
        summary: 'مهندس برمجيات متمرس مع خبرة 5 سنوات في تطوير التطبيقات الويب والهاتف المحمول. متخصص في React و Node.js مع خبرة في بناء أنظمة قابلة للتطوير.'
      },
      experience: [
        {
          jobTitle: 'مهندس برمجيات أول',
          company: 'شركة التقنية المتقدمة',
          startDate: '2020-01',
          endDate: 'الحالي',
          description: 'قيادة فريق التطوير وتصميم معماريات الأنظمة. تطوير واجهات مستخدم تفاعلية باستخدام React و Redux. تحسين أداء التطبيقات بنسبة 40%.'
        },
        {
          jobTitle: 'مهندس برمجيات',
          company: 'شركة الحلول الرقمية',
          startDate: '2018-06',
          endDate: '2019-12',
          description: 'تطوير تطبيقات ويب باستخدام React و Node.js. بناء واجهات برمجية RESTful APIs. العمل مع فرق متعددة التخصصات.'
        }
      ],
      education: [
        {
          degree: 'بكالوريوس',
          field: 'هندسة البرمجيات',
          institution: 'جامعة الملك سعود',
          graduationDate: '2018-05'
        }
      ],
      skills: ['JavaScript', 'React', 'Node.js', 'Python', 'SQL', 'Git', 'Docker', 'AWS'],
      certifications: [
        {
          certificateName: 'AWS Certified Solutions Architect',
          issuer: 'Amazon Web Services',
          issueDate: '2021-03'
        }
      ],
      projects: [
        {
          projectName: 'تطبيق إدارة المشاريع',
          projectLink: 'https://github.com/example/project',
          description: 'تطبيق ويب لإدارة المشاريع والمهام باستخدام React و Node.js. يدعم التعاون في الوقت الفعلي.'
        }
      ]
    };

    // ============ دوال العرض المحسّنة ============

    function renderPage() {
      const app = document.getElementById('app');
      
      switch(AppState.currentPage) {
        case 'home':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderHome() + '</div>' + renderFooter();
          break;
        case 'builder':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderBuilder() + '</div>' + renderFooter();
          break;
        case 'templates':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderTemplates() + '</div>' + renderFooter();
          break;
        case 'auth':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderAuth() + '</div>' + renderFooter();
          break;
        case 'dashboard':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderDashboard() + '</div>' + renderFooter();
          break;
        case 'contact':
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderContact() + '</div>' + renderFooter();
          break;
        default:
          app.innerHTML = renderHeader() + '<div id="app-content">' + renderHome() + '</div>' + renderFooter();
      }
      
      attachEventListeners();
      renderMobileMenu();
    }

    function renderHome() {
      return `
        <main>
          <section class="hero">
            <div class="container">
              <div class="hero-content">
                <h1>${t('heroTitle')}</h1>
                <p class="subtitle">${t('heroSubtitle')}</p>
                <div class="hero-buttons">
                  <button class="btn btn-secondary btn-large" onclick="navigateTo('builder')">
                    <i class="fas fa-rocket"></i> ${t('startNow')}
                  </button>
                  <button class="btn btn-outline btn-large" onclick="navigateTo('templates')">
                    <i class="fas fa-eye"></i> ${t('quickTemplates')}
                  </button>
                </div>
              </div>
            </div>
          </section>

          <section class="features-section">
            <div class="container">
              <div class="section-title">
                <h2>لماذا تختار CV Studio؟</h2>
                <p>نحن نوفر لك كل ما تحتاجه لإنشاء سيرة ذاتية احترافية</p>
              </div>
              
              <div class="features-grid">
                <div class="feature-card">
                  <div class="feature-icon">
                    <i class="fas fa-file-alt"></i>
                  </div>
                  <h3>${t('feature1Title')}</h3>
                  <p>${t('feature1Desc')}</p>
                </div>

                <div class="feature-card">
                  <div class="feature-icon">
                    <i class="fas fa-search"></i>
                  </div>
                  <h3>${t('feature2Title')}</h3>
                  <p>${t('feature2Desc')}</p>
                </div>

                <div class="feature-card">
                  <div class="feature-icon">
                    <i class="fas fa-download"></i>
                  </div>
                  <h3>${t('feature3Title')}</h3>
                  <p>${t('feature3Desc')}</p>
                </div>

                <div class="feature-card">
                  <div class="feature-icon">
                    <i class="fas fa-eye"></i>
                  </div>
                  <h3>${t('feature4Title')}</h3>
                  <p>${t('feature4Desc')}</p>
                </div>
              </div>
            </div>
          </section>

          <section class="stats-section">
            <div class="container">
              <div class="stats-grid">
                <div class="stat-item">
                  <div class="stat-number">${t('stats1')}</div>
                  <div class="stat-label">${t('stats1Label')}</div>
                </div>
                <div class="stat-item">
                  <div class="stat-number">${t('stats2')}</div>
                  <div class="stat-label">${t('stats2Label')}</div>
                </div>
                <div class="stat-item">
                  <div class="stat-number">${t('stats3')}</div>
                  <div class="stat-label">${t('stats3Label')}</div>
                </div>
                <div class="stat-item">
                  <div class="stat-number">${t('stats4')}</div>
                  <div class="stat-label">${t('stats4Label')}</div>
                </div>
              </div>
            </div>
          </section>

          <section class="cta-section">
            <div class="container">
              <div class="cta-content">
                <h2>${t('ctaTitle')}</h2>
                <p>${t('ctaSubtitle')}</p>
                <button class="btn btn-primary btn-large" onclick="navigateTo('builder')">
                  <i class="fas fa-arrow-left"></i> ${t('startNow')}
                </button>
              </div>
            </div>
          </section>
        </main>
      `;
    }

    function renderBuilder() {
      const atsSystem = ATSSystems[AppState.selectedATS];
      const photoWarning = !atsSystem.supportsPhotos ? 
        `<div class="ats-warning">⚠️ ${t('atsNotSupportsPhoto')}</div>` : '';

      return `
        <main class="page">
          <div class="container">
            <div class="builder-layout">
              <aside class="builder-sidebar">
                <h3 style="margin-bottom: 1rem;">${t('selectATS')}</h3>
                <select id="ats-select" class="form-group" style="width: 100%; margin-bottom: 1rem;">
                  ${Object.entries(ATSSystems).map(([key, system]) => `
                    <option value="${key}" ${AppState.selectedATS === key ? 'selected' : ''}>
                      ${system.name}
                    </option>
                  `).join('')}
                </select>
                
                <div class="ats-compatibility-indicator ${atsSystem.compatibility}">
                  <i class="fas fa-${atsSystem.compatibility === 'high' ? 'check-circle' : atsSystem.compatibility === 'medium' ? 'exclamation-circle' : 'times-circle'}"></i>
                  ${t('atsCompatibility' + atsSystem.compatibility.charAt(0).toUpperCase() + atsSystem.compatibility.slice(1))}
                </div>

                ${photoWarning}

                <h3 style="margin-bottom: 1rem;">${t('selectTemplate')}</h3>
                <select id="template-select" class="form-group" style="width: 100%; margin-bottom: 1rem;">
                  ${Object.entries(ResumeTemplates).map(([key, template]) => `
                    <option value="${key}" ${AppState.currentTemplate === key ? 'selected' : ''}>
                      ${template.name}
                    </option>
                  `).join('')}
                </select>

                <div class="ats-recommendations">
                  <h4>${t('atsRecommendations')}</h4>
                  <ul>
                    ${atsSystem.recommendations.map(rec => `
                      <li>${rec}</li>
                    `).join('')}
                  </ul>
                </div>

                <div style="margin-bottom: 1rem;">
                  <strong>الأقسام</strong>
                </div>

                <div class="nav-item active" onclick="switchSection('personal', event)">
                  📋 ${t('personalInfo')}
                </div>
                <div class="nav-item" onclick="switchSection('experience', event)">
                  💼 ${t('experience')}
                </div>
                <div class="nav-item" onclick="switchSection('education', event)">
                  🎓 ${t('education')}
                </div>
                <div class="nav-item" onclick="switchSection('skills', event)">
                  ⭐ ${t('skills')}
                </div>
                <div class="nav-item" onclick="switchSection('certifications', event)">
                  🏆 ${t('certifications')}
                </div>
                <div class="nav-item" onclick="switchSection('projects', event)">
                  🚀 ${t('projects')}
                </div>

                <div style="margin-top: 2rem; display: flex; gap: 0.5rem;">
                  <button class="btn btn-primary btn-small" onclick="saveDraft()" style="flex: 1;">
                    <i class="fas fa-save"></i> ${t('saveDraft')}
                  </button>
                  <button class="btn btn-secondary btn-small" onclick="exportPDF()" style="flex: 1;">
                    <i class="fas fa-download"></i> ${t('exportPDF')}
                  </button>
                </div>
              </aside>

              <div class="builder-content">
                <div class="builder-form">
                  <div id="form-section">
                    <!-- سيتم ملؤه ديناميكياً -->
                  </div>
                </div>

                <div class="builder-preview">
                  <div style="margin-bottom: 1rem; display: flex; gap: 0.5rem;">
                    <button class="btn btn-outline btn-small" onclick="togglePreviewMode('formatted')" style="flex: 1;">
                      <i class="fas fa-eye"></i> ${t('viewAsFormatted')}
                    </button>
                    <button class="btn btn-outline btn-small" onclick="togglePreviewMode('text')" style="flex: 1;">
                      <i class="fas fa-file-alt"></i> ${t('viewAsText')}
                    </button>
                  </div>
                  <div id="preview-section" class="resume-template">
                    <!-- سيتم ملؤه ديناميكياً -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      `;
    }

    function renderTemplates() {
      return `
        <main class="page">
          <section class="section">
            <div class="container">
              <div class="section-title">
                <h2>${t('quickTemplates')}</h2>
                <p>اختر القالب الذي يناسب احتياجاتك</p>
              </div>

              <div class="template-grid">
                ${Object.entries(ResumeTemplates).map(([key, template]) => `
                  <div class="template-card" onclick="selectTemplate('${key}')">
                    <div class="template-preview">
                      <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="template-info">
                      <h3>${template.name}</h3>
                      <span class="template-badge ${template.atsFriendly ? 'ats-friendly' : 'not-ats-friendly'}">
                        ${template.atsFriendly ? t('atsFriendly') : t('notAtsFriendly')}
                      </span>
                      <div class="ats-compatibility-indicator ${template.compatibility}">
                        <i class="fas fa-${template.compatibility === 'high' ? 'check-circle' : template.compatibility === 'medium' ? 'exclamation-circle' : 'times-circle'}"></i>
                        ${t('atsCompatibility' + template.compatibility.charAt(0).toUpperCase() + template.compatibility.slice(1))}
                      </div>
                      <p>${template.description}</p>
                      <ul style="margin: 1rem 0; padding-right: 1rem;">
                        ${template.features.map(f => `<li style="margin-bottom: 0.5rem; font-size: 0.9rem;">${f}</li>`).join('')}
                      </ul>
                      <button class="btn btn-primary btn-small" onclick="selectTemplate('${key}'); navigateTo('builder');">
                        ${t('preview')}
                      </button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          </section>
        </main>
      `;
    }

    function renderAuth() {
      return `
        <main class="page">
          <div class="auth-container">
            <div class="auth-wrapper">
              <div class="auth-info">
                <h2>${AppState.authMode === 'login' ? t('welcomeBack') : t('createAccount')}</h2>
                <p>${AppState.authMode === 'login' ? t('loginDesc') : t('signupDesc')}</p>
                <div class="feature-card" style="background-color: rgba(255, 255, 255, 0.1); color: white; margin-bottom: 1rem;">
                  <div class="feature-icon" style="background-color: rgba(255, 255, 255, 0.2);">
                    <i class="fas fa-file-alt"></i>
                  </div>
                  <h3 style="color: white;">${t('createProfessional')}</h3>
                  <p>أنشئ سيرة ذاتية احترافية باستخدام قوالب مصممة بعناية</p>
                </div>
                <div class="feature-card" style="background-color: rgba(255, 255, 255, 0.1); color: white;">
                  <div class="feature-icon" style="background-color: rgba(255, 255, 255, 0.2);">
                    <i class="fas fa-search"></i>
                  </div>
                  <h3 style="color: white;">${t('atsPreview')}</h3>
                  <p>اعرض كيف سيقرأ نظام التوظيف سيرتك الذاتية</p>
                </div>
              </div>
              <div class="auth-form">
                <div class="auth-tabs">
                  <div class="auth-tab ${AppState.authMode === 'login' ? 'active' : ''}" onclick="switchAuthMode('login')">
                    ${t('login')}
                  </div>
                  <div class="auth-tab ${AppState.authMode === 'signup' ? 'active' : ''}" onclick="switchAuthMode('signup')">
                    ${t('signup')}
                  </div>
                </div>
                <div class="auth-card">
                  ${AppState.authMode === 'login' ? renderLoginForm() : renderSignupForm()}
                </div>
              </div>
            </div>
          </div>
        </main>
      `;
    }

    function renderLoginForm() {
      return `
        <h2>${t('login')}</h2>
        <form id="login-form" onsubmit="handleLogin(event)">
          <div class="form-group">
            <label>${t('email')}</label>
            <input type="email" required placeholder="you@example.com">
          </div>

          <div class="form-group">
            <label>${t('password')}</label>
            <input type="password" required placeholder="••••••••">
          </div>

          <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
            <label style="margin: 0;">
              <input type="checkbox"> ${t('rememberMe')}
            </label>
            <a href="#" onclick="alert('سيتم إضافة هذه الميزة قريباً')">${t('forgotPassword')}</a>
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">
            ${t('login')}
          </button>
        </form>

        <div class="auth-divider">
          <span>أو</span>
        </div>

        <div class="social-login">
          <button class="social-btn" onclick="alert('Google login mock')">
            <i class="fab fa-google"></i> Google
          </button>
          <button class="social-btn" onclick="alert('Facebook login mock')">
            <i class="fab fa-facebook"></i> Facebook
          </button>
        </div>
      `;
    }

    function renderSignupForm() {
      return `
        <h2>${t('createAccount')}</h2>
        <form id="signup-form" onsubmit="handleSignup(event)">
          <div class="form-group">
            <label>${t('fullName')}</label>
            <input type="text" required placeholder="الاسم الكامل">
          </div>

          <div class="form-group">
            <label>${t('email')}</label>
            <input type="email" required placeholder="you@example.com">
          </div>

          <div class="form-group">
            <label>${t('password')}</label>
            <input type="password" required placeholder="••••••••">
          </div>

          <div class="form-group">
            <label>${t('confirmPassword')}</label>
            <input type="password" required placeholder="••••••••">
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">
            ${t('createAccount')}
          </button>
        </form>

        <div class="auth-terms">
          ${t('termsAgree')} <a href="#">${t('termsOfService')}</a> ${t('and')} <a href="#">${t('privacyPolicy')}</a>
        </div>

        <div class="auth-divider">
          <span>أو</span>
        </div>

        <div class="social-login">
          <button class="social-btn" onclick="alert('Google signup mock')">
            <i class="fab fa-google"></i> Google
          </button>
          <button class="social-btn" onclick="alert('Facebook signup mock')">
            <i class="fab fa-facebook"></i> Facebook
          </button>
        </div>
      `;
    }

    function renderDashboard() {
      const mockResumes = [
        { id: 1, name: 'سيرتي الأولى', date: '2024-12-09', atsSystem: 'Workday', template: 'modern' },
        { id: 2, name: 'سيرة تقنية', date: '2024-12-08', atsSystem: 'Generic', template: 'ats-simple' }
      ];

      return `
        <main class="page">
          <section class="section">
            <div class="container">
              <div class="flex-between" style="margin-bottom: 2rem;">
                <h2>${t('myResumes')}</h2>
                <button class="btn btn-primary" onclick="navigateTo('builder')">
                  <i class="fas fa-plus"></i> ${t('newResume')}
                </button>
              </div>

              <div class="dashboard-grid">
                ${mockResumes.map(resume => `
                  <div class="resume-item">
                    <div class="resume-item-header">
                      <div>
                        <div class="resume-item-title">${resume.name}</div>
                        <div class="resume-item-date">${t('lastModified')}: ${resume.date}</div>
                      </div>
                    </div>
                    <div style="font-size: 0.9rem; color: #6B7280;">
                      ATS: ${resume.atsSystem} | القالب: ${ResumeTemplates[resume.template]?.name || resume.template}
                    </div>
                    <div class="resume-item-actions">
                      <button class="btn btn-primary btn-small" onclick="navigateTo('builder')">
                        <i class="fas fa-edit"></i> ${t('edit')}
                      </button>
                      <button class="btn btn-outline btn-small" onclick="alert('معاينة السيرة')">
                        <i class="fas fa-eye"></i> ${t('preview')}
                      </button>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          </section>
        </main>
      `;
    }

    function renderContact() {
      return `
        <main class="page">
          <section class="section">
            <div class="container">
              <div class="contact-container">
                <div class="contact-wrapper">
                  <div class="contact-info">
                    <h2>${t('contactTitle')}</h2>
                    <p>${t('contactSubtitle')}</p>
                    
                    <div class="contact-item">
                      <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                      </div>
                      <div class="contact-details">
                        <h4>${t('contactEmail')}</h4>
                        <p>support@cvstudio.com</p>
                      </div>
                    </div>
                    
                    <div class="contact-item">
                      <div class="contact-icon">
                        <i class="fas fa-phone"></i>
                      </div>
                      <div class="contact-details">
                        <h4>${t('contactPhone')}</h4>
                        <p>+966 50 123 4567</p>
                      </div>
                    </div>
                    
                    <div class="contact-item">
                      <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                      </div>
                      <div class="contact-details">
                        <h4>${t('contactAddress')}</h4>
                        <p>الرياض، المملكة العربية السعودية</p>
                      </div>
                    </div>
                    
                    <div class="contact-item">
                      <div class="contact-icon">
                        <i class="fas fa-clock"></i>
                      </div>
                      <div class="contact-details">
                        <h4>${t('contactHours')}</h4>
                        <p>الأحد - الخميس: 9:00 ص - 5:00 م</p>
                      </div>
                    </div>
                  </div>
                  
                  <div class="contact-form">
                    <h3>أرسل لنا رسالة</h3>
                    <form onsubmit="handleContactSubmit(event)">
                      <div class="form-group">
                        <label>${t('contactName')}</label>
                        <input type="text" required placeholder="أدخل اسمك الكامل">
                      </div>
                      
                      <div class="form-group">
                        <label>${t('email')}</label>
                        <input type="email" required placeholder="your@email.com">
                      </div>
                      
                      <div class="form-group">
                        <label>${t('contactSubject')}</label>
                        <input type="text" required placeholder="موضوع الرسالة">
                      </div>
                      
                      <div class="form-group">
                        <label>${t('contactMessage')}</label>
                        <textarea required rows="5" placeholder="اكتب رسالتك هنا..."></textarea>
                      </div>
                      
                      <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-paper-plane"></i> ${t('contactSend')}
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </main>
      `;
    }

    function renderHeader() {
      return `
        <header>
          <div class="container">
            <div class="header-content">
              <a href="#" onclick="navigateTo('home')" class="logo">
                <div class="logo-icon">CV</div>
                <span>${t('appTitle')}</span>
              </a>
              <nav>
                <button class="mobile-nav-toggle" aria-label="Toggle menu" onclick="toggleMobileMenu()">
                  <i class="fas fa-bars"></i>
                </button>
                <div id="main-nav" class="main-nav">
                  <a href="#" onclick="navigateTo('home')" class="${AppState.currentPage === 'home' ? 'active' : ''} nav-link">
                    <i class="fas fa-home"></i> ${t('home')}
                  </a>
                  <a href="#" onclick="navigateTo('builder')" class="${AppState.currentPage === 'builder' ? 'active' : ''} nav-link">
                    <i class="fas fa-edit"></i> ${t('builder')}
                  </a>
                  <a href="#" onclick="navigateTo('templates')" class="${AppState.currentPage === 'templates' ? 'active' : ''} nav-link">
                    <i class="fas fa-file-alt"></i> ${t('templates')}
                  </a>
                  <a href="#" onclick="navigateTo('contact')" class="${AppState.currentPage === 'contact' ? 'active' : ''} nav-link">
                    <i class="fas fa-envelope"></i> ${t('contact')}
                  </a>
                  ${AppState.userAuth.isLoggedIn ? `
                    <a href="#" onclick="navigateTo('dashboard')" class="${AppState.currentPage === 'dashboard' ? 'active' : ''} nav-link">
                      <i class="fas fa-tachometer-alt"></i> ${t('dashboard')}
                    </a>
                    <button class="btn btn-outline btn-small" onclick="logout()">
                      <i class="fas fa-sign-out-alt"></i> ${t('logout')}
                    </button>
                  ` : `
                    <button class="btn btn-primary btn-small" onclick="navigateTo('auth')">
                      <i class="fas fa-sign-in-alt"></i> ${t('login')}
                    </button>
                  `}
                  <button class="lang-toggle" onclick="toggleLanguage()">
                    <i class="fas fa-globe"></i> ${AppState.currentLanguage === 'ar' ? 'EN' : 'AR'}
                  </button>
                </div>
              </nav>
            </div>
          </div>
        </header>
      `;
    }

    function renderFooter() {
      return `
        <footer>
          <div class="container">
            <div class="footer-content">
              <div class="footer-section">
                <h4>${t('appTitle')}</h4>
                <p>${t('footerDescription')}</p>
                <div class="social-links">
                  <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                  <a href="#" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                  <a href="#" title="Facebook"><i class="fab fa-facebook"></i></a>
                  <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                </div>
              </div>
              <div class="footer-section">
                <h4>${t('footerLinks')}</h4>
                <ul>
                  <li><a href="#" onclick="navigateTo('home')" class="nav-link">${t('home')}</a></li>
                  <li><a href="#" onclick="navigateTo('templates')" class="nav-link">${t('templates')}</a></li>
                  <li><a href="#" onclick="alert('سيتم إضافة صفحة الأسئلة الشائعة')" class="nav-link">${t('footerFAQ')}</a></li>
                </ul>
              </div>
              <div class="footer-section">
                <h4>${t('footerContact')}</h4>
                <ul>
                  <li><a href="mailto:support@cvstudio.com">support@cvstudio.com</a></li>
                  <li><a href="#">+966 50 123 4567</a></li>
                  <li><a href="#">${t('footerTwitter')}</a></li>
                  <li><a href="#">${t('footerLinkedIn')}</a></li>
                </ul>
              </div>
            </div>
            <div class="footer-bottom">
              <p>&copy; 2024 CV Studio. ${t('footerCopyright')}.</p>
            </div>
          </div>
        </footer>
      `;
    }

    function renderMobileMenu() {
      const menuContent = document.querySelector('.mobile-menu-content');
      if (menuContent) {
        menuContent.innerHTML = `
          <a href="#" onclick="navigateTo('home'); closeMobileMenu();" class="nav-link">
            <i class="fas fa-home"></i> ${t('home')}
          </a>
          <a href="#" onclick="navigateTo('builder'); closeMobileMenu();" class="nav-link">
            <i class="fas fa-edit"></i> ${t('builder')}
          </a>
          <a href="#" onclick="navigateTo('templates'); closeMobileMenu();" class="nav-link">
            <i class="fas fa-file-alt"></i> ${t('templates')}
          </a>
          <a href="#" onclick="navigateTo('contact'); closeMobileMenu();" class="nav-link">
            <i class="fas fa-envelope"></i> ${t('contact')}
          </a>
          ${AppState.userAuth.isLoggedIn ? `
            <a href="#" onclick="navigateTo('dashboard'); closeMobileMenu();" class="nav-link">
              <i class="fas fa-tachometer-alt"></i> ${t('dashboard')}
            </a>
            <button class="btn btn-outline" onclick="logout(); closeMobileMenu();">
              <i class="fas fa-sign-out-alt"></i> ${t('logout')}
            </button>
          ` : `
            <button class="btn btn-primary" onclick="navigateTo('auth'); closeMobileMenu();">
              <i class="fas fa-sign-in-alt"></i> ${t('login')}
            </button>
          `}
          <button class="lang-toggle" onclick="toggleLanguage(); closeMobileMenu();">
            <i class="fas fa-globe"></i> ${AppState.currentLanguage === 'ar' ? 'EN' : 'AR'}
          </button>
        `;
      }
    }

    // ============ وظائف التفاعل المحسّنة ============

    function switchSection(section, evt) {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });

      if (evt && evt.target) {
        const el = evt.target.closest('.nav-item');
        if (el) el.classList.add('active');
      }

      renderFormSection(section);
      updatePreview();

      const formSection = document.getElementById('form-section');
      if (formSection) {
        const inputs = Array.from(formSection.querySelectorAll('input, textarea, select'));
        let el = null;
        if (inputs.length) {
          el = inputs.find(i => (i.value || '').trim() === '') || inputs[0];
        }
        if (el) {
          setTimeout(() => {
            try { el.focus(); } catch (e) {}
            try { el.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (e) {}
          }, 120);
        }
      }
    }

    function renderFormSection(section) {
      const formSection = document.getElementById('form-section');
      const data = AppState.resumeData;

      switch(section) {
        case 'personal':
          formSection.innerHTML = `
            <h3>${t('personalInfo')}</h3>
            <div class="form-group">
              <label>${t('fullName')} *</label>
              <input type="text" id="fullName" value="${data.personalInfo.fullName}" 
                     onchange="updateResumeData('personalInfo', 'fullName', this.value); updatePreview();"
                     placeholder="أحمد محمد علي">
            </div>
            <div class="form-group">
              <label>${t('email')} *</label>
              <input type="email" id="email" value="${data.personalInfo.email}"
                     onchange="updateResumeData('personalInfo', 'email', this.value); updatePreview();"
                     placeholder="ahmed@example.com">
            </div>
            <div class="form-group">
              <label>${t('phone')}</label>
              <input type="tel" id="phone" value="${data.personalInfo.phone}"
                     onchange="updateResumeData('personalInfo', 'phone', this.value); updatePreview();"
                     placeholder="+966 50 123 4567">
            </div>
            <div class="form-group">
              <label>${t('location')}</label>
              <input type="text" id="location" value="${data.personalInfo.location}"
                     onchange="updateResumeData('personalInfo', 'location', this.value); updatePreview();"
                     placeholder="الرياض، السعودية">
            </div>
            <div class="form-group">
              <label>${t('website')}</label>
              <input type="url" id="website" value="${data.personalInfo.website}"
                     onchange="updateResumeData('personalInfo', 'website', this.value); updatePreview();"
                     placeholder="https://example.com">
            </div>
            <div class="form-group">
              <label>${t('summary')}</label>
              <textarea id="summary" onchange="updateResumeData('personalInfo', 'summary', this.value); updatePreview();"
                        placeholder="ملخص احترافي عن خبراتك ومهاراتك...">${data.personalInfo.summary}</textarea>
            </div>
            <div class="form-group">
              <label>صورة شخصية (اختياري)</label>
              <input type="file" id="photo" accept="image/*" onchange="handlePhotoUpload(event);">
              ${!ATSSystems[AppState.selectedATS].supportsPhotos ? 
                `<div class="form-hint" style="color: #F59E0B;">${t('photoWarning')}</div>` : ''}
            </div>
          `;
          break;

        case 'experience':
          formSection.innerHTML = `
            <h3>${t('experience')}</h3>
            ${data.experience.map((exp, idx) => `
              <div class="card" style="margin-bottom: 1rem;">
                <div class="form-group">
                  <label>${t('jobTitle')} *</label>
                  <input type="text" value="${exp.jobTitle}" 
                         onchange="updateExperience(${idx}, 'jobTitle', this.value); updatePreview();"
                         placeholder="مطور واجهات أمامية">
                </div>
                <div class="form-group">
                  <label>${t('company')} *</label>
                  <input type="text" value="${exp.company}"
                         onchange="updateExperience(${idx}, 'company', this.value); updatePreview();"
                         placeholder="شركة التقنية المتقدمة">
                </div>
                <div class="form-group">
                  <label>${t('startDate')}</label>
                  <input type="month" value="${exp.startDate}"
                         onchange="updateExperience(${idx}, 'startDate', this.value); updatePreview();">
                </div>
                <div class="form-group">
                  <label>${t('endDate')}</label>
                  <input type="month" value="${exp.endDate}"
                         onchange="updateExperience(${idx}, 'endDate', this.value); updatePreview();"
                         placeholder="الحالي">
                </div>
                <div class="form-group">
                  <label>${t('description')}</label>
                  <textarea onchange="updateExperience(${idx}, 'description', this.value); updatePreview();"
                            placeholder="صف مسؤولياتك وإنجازاتك...">${exp.description}</textarea>
                </div>
                <button class="btn btn-outline btn-small" onclick="removeExperience(${idx}); updatePreview();">
                  <i class="fas fa-trash"></i> ${t('delete')}
                </button>
              </div>
            `).join('')}
            <button class="btn btn-primary" onclick="addExperience(); switchSection('experience');">
              <i class="fas fa-plus"></i> ${t('add')} ${t('experience')}
            </button>
          `;
          break;

        case 'education':
          formSection.innerHTML = `
            <h3>${t('education')}</h3>
            ${data.education.map((edu, idx) => `
              <div class="card" style="margin-bottom: 1rem;">
                <div class="form-group">
                  <label>${t('degree')} *</label>
                  <input type="text" value="${edu.degree}"
                         onchange="updateEducation(${idx}, 'degree', this.value); updatePreview();"
                         placeholder="بكالوريوس">
                </div>
                <div class="form-group">
                  <label>${t('field')} *</label>
                  <input type="text" value="${edu.field}"
                         onchange="updateEducation(${idx}, 'field', this.value); updatePreview();"
                         placeholder="هندسة البرمجيات">
                </div>
                <div class="form-group">
                  <label>${t('institution')} *</label>
                  <input type="text" value="${edu.institution}"
                         onchange="updateEducation(${idx}, 'institution', this.value); updatePreview();"
                         placeholder="جامعة الملك سعود">
                </div>
                <div class="form-group">
                  <label>${t('graduationDate')}</label>
                  <input type="month" value="${edu.graduationDate}"
                         onchange="updateEducation(${idx}, 'graduationDate', this.value); updatePreview();">
                </div>
                <button class="btn btn-outline btn-small" onclick="removeEducation(${idx}); updatePreview();">
                  <i class="fas fa-trash"></i> ${t('delete')}
                </button>
              </div>
            `).join('')}
            <button class="btn btn-primary" onclick="addEducation(); switchSection('education');">
              <i class="fas fa-plus"></i> ${t('add')} ${t('education')}
            </button>
          `;
          break;

        case 'skills':
          formSection.innerHTML = `
            <h3>${t('skills')}</h3>
            ${data.skills.map((skill, idx) => `
              <div class="form-group">
                <div class="flex-between">
                  <input type="text" value="${skill}" style="flex: 1;"
                         onchange="updateSkill(${idx}, this.value); updatePreview();"
                         placeholder="JavaScript">
                  <button class="btn btn-outline btn-small" onclick="removeSkill(${idx}); updatePreview();" style="margin-right: 0.5rem;">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
            `).join('')}
            <button class="btn btn-primary" onclick="addSkill(); switchSection('skills');">
              <i class="fas fa-plus"></i> ${t('add')} ${t('skills')}
            </button>
          `;
          break;

        case 'certifications':
          formSection.innerHTML = `
            <h3>${t('certifications')}</h3>
            ${data.certifications.map((cert, idx) => `
              <div class="card" style="margin-bottom: 1rem;">
                <div class="form-group">
                  <label>${t('certificateName')} *</label>
                  <input type="text" value="${cert.certificateName}"
                         onchange="updateCertification(${idx}, 'certificateName', this.value); updatePreview();"
                         placeholder="AWS Certified Solutions Architect">
                </div>
                <div class="form-group">
                  <label>${t('issuer')} *</label>
                  <input type="text" value="${cert.issuer}"
                         onchange="updateCertification(${idx}, 'issuer', this.value); updatePreview();"
                         placeholder="Amazon Web Services">
                </div>
                <div class="form-group">
                  <label>${t('issueDate')}</label>
                  <input type="month" value="${cert.issueDate}"
                         onchange="updateCertification(${idx}, 'issueDate', this.value); updatePreview();">
                </div>
                <button class="btn btn-outline btn-small" onclick="removeCertification(${idx}); updatePreview();">
                  <i class="fas fa-trash"></i> ${t('delete')}
                </button>
              </div>
            `).join('')}
            <button class="btn btn-primary" onclick="addCertification(); switchSection('certifications');">
              <i class="fas fa-plus"></i> ${t('add')} ${t('certifications')}
            </button>
          `;
          break;

        case 'projects':
          formSection.innerHTML = `
            <h3>${t('projects')}</h3>
            ${data.projects.map((proj, idx) => `
              <div class="card" style="margin-bottom: 1rem;">
                <div class="form-group">
                  <label>${t('projectName')} *</label>
                  <input type="text" value="${proj.projectName}"
                         onchange="updateProject(${idx}, 'projectName', this.value); updatePreview();"
                         placeholder="تطبيق إدارة المشاريع">
                </div>
                <div class="form-group">
                  <label>${t('projectLink')}</label>
                  <input type="url" value="${proj.projectLink}"
                         onchange="updateProject(${idx}, 'projectLink', this.value); updatePreview();"
                         placeholder="https://github.com/username/project">
                </div>
                <div class="form-group">
                  <label>${t('description')}</label>
                  <textarea onchange="updateProject(${idx}, 'description', this.value); updatePreview();"
                            placeholder="صف المشروع والتقنيات المستخدمة...">${proj.description}</textarea>
                </div>
                <button class="btn btn-outline btn-small" onclick="removeProject(${idx}); updatePreview();">
                  <i class="fas fa-trash"></i> ${t('delete')}
                </button>
              </div>
            `).join('')}
            <button class="btn btn-primary" onclick="addProject(); switchSection('projects');">
              <i class="fas fa-plus"></i> ${t('add')} ${t('projects')}
            </button>
          `;
          break;
      }
    }

    function updateResumeData(section, field, value) {
      AppState.resumeData[section][field] = value;
      saveToLocalStorage();
    }

    function updateExperience(idx, field, value) {
      AppState.resumeData.experience[idx][field] = value;
      saveToLocalStorage();
    }

    function updateEducation(idx, field, value) {
      AppState.resumeData.education[idx][field] = value;
      saveToLocalStorage();
    }

    function updateSkill(idx, value) {
      AppState.resumeData.skills[idx] = value;
      saveToLocalStorage();
    }

    function updateCertification(idx, field, value) {
      AppState.resumeData.certifications[idx][field] = value;
      saveToLocalStorage();
    }

    function updateProject(idx, field, value) {
      AppState.resumeData.projects[idx][field] = value;
      saveToLocalStorage();
    }

    function addExperience() {
      AppState.resumeData.experience.push({
        jobTitle: '',
        company: '',
        startDate: '',
        endDate: '',
        description: ''
      });
      saveToLocalStorage();
    }

    function removeExperience(idx) {
      AppState.resumeData.experience.splice(idx, 1);
      saveToLocalStorage();
    }

    function addEducation() {
      AppState.resumeData.education.push({
        degree: '',
        field: '',
        institution: '',
        graduationDate: ''
      });
      saveToLocalStorage();
    }

    function removeEducation(idx) {
      AppState.resumeData.education.splice(idx, 1);
      saveToLocalStorage();
    }

    function addSkill() {
      AppState.resumeData.skills.push('');
      saveToLocalStorage();
    }

    function removeSkill(idx) {
      AppState.resumeData.skills.splice(idx, 1);
      saveToLocalStorage();
    }

    function addCertification() {
      AppState.resumeData.certifications.push({
        certificateName: '',
        issuer: '',
        issueDate: ''
      });
      saveToLocalStorage();
    }

    function removeCertification(idx) {
      AppState.resumeData.certifications.splice(idx, 1);
      saveToLocalStorage();
    }

    function addProject() {
      AppState.resumeData.projects.push({
        projectName: '',
        projectLink: '',
        description: ''
      });
      saveToLocalStorage();
    }

    function removeProject(idx) {
      AppState.resumeData.projects.splice(idx, 1);
      saveToLocalStorage();
    }

    function updatePreview() {
      const previewSection = document.getElementById('preview-section');
      if (!previewSection) return;

      const data = AppState.resumeData;
      const template = AppState.currentTemplate;
      const atsSystem = ATSSystems[AppState.selectedATS];

      // إضافة كلاس القالب
      previewSection.className = `resume-template ${template}`;

      // تحديد الألوان حسب القالب
      let textColor = '#1F2937';
      let secondaryColor = '#4B5563';
      let accentColor = '#0B3D91';
      
      if (template === 'creative') {
        textColor = '#ffffff';
        secondaryColor = 'rgba(255, 255, 255, 0.9)';
        accentColor = '#ffffff';
      } else if (template === 'executive') {
        textColor = '#e0e0e0';
        secondaryColor = '#b0b0b0';
        accentColor = '#c99a6b';
      }

      // بناء HTML للسيرة الذاتية حسب القالب
      let resumeHTML = '';

      if (template === 'ats-simple') {
        // قالب ATS بسيط - نصي بحت
        resumeHTML = `
          <div class="resume-header">
            <div class="resume-name">${escapeHTML(data.personalInfo.fullName) || 'الاسم الكامل'}</div>
            <div class="resume-contact">
              ${data.personalInfo.email ? `<div class="contact-item">${escapeHTML(data.personalInfo.email)}</div>` : ''}
              ${data.personalInfo.phone ? `<div class="contact-item">${escapeHTML(data.personalInfo.phone)}</div>` : ''}
              ${data.personalInfo.location ? `<div class="contact-item">${escapeHTML(data.personalInfo.location)}</div>` : ''}
              ${data.personalInfo.website ? `<div class="contact-item">${escapeHTML(data.personalInfo.website)}</div>` : ''}
            </div>
          </div>

          ${data.personalInfo.summary ? `
            <div class="resume-section">
              <div class="resume-section-title">PROFESSIONAL SUMMARY</div>
              <div class="resume-entry-description">${escapeHTML(data.personalInfo.summary)}</div>
            </div>
          ` : ''}

          ${data.experience.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title">PROFESSIONAL EXPERIENCE</div>
              ${data.experience.map(exp => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title">${escapeHTML(exp.jobTitle) || 'Job Title'}</div>
                    <div class="resume-entry-date">${exp.startDate || 'Start Date'} - ${exp.endDate || 'Present'}</div>
                  </div>
                  <div class="resume-entry-subtitle">${escapeHTML(exp.company) || 'Company'}</div>
                  ${exp.description ? `<div class="resume-entry-description">${escapeHTML(exp.description)}</div>` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.education.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title">EDUCATION</div>
              ${data.education.map(edu => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title">${escapeHTML(edu.degree)} in ${escapeHTML(edu.field)}</div>
                    <div class="resume-entry-date">${edu.graduationDate || 'Graduation Date'}</div>
                  </div>
                  <div class="resume-entry-subtitle">${escapeHTML(edu.institution)}</div>
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.skills.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title">SKILLS</div>
              <div class="resume-entry-description">${data.skills.filter(s => s).join(', ')}</div>
            </div>
          ` : ''}

          ${data.certifications.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title">CERTIFICATIONS</div>
              ${data.certifications.map(cert => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title">${escapeHTML(cert.certificateName)}</div>
                    <div class="resume-entry-date">${cert.issueDate || 'Issue Date'}</div>
                  </div>
                  <div class="resume-entry-subtitle">${escapeHTML(cert.issuer)}</div>
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.projects.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title">PROJECTS</div>
              ${data.projects.map(proj => `
                <div class="resume-entry">
                  <div class="resume-entry-title">${escapeHTML(proj.projectName)}</div>
                  ${proj.projectLink ? `<div class="resume-entry-subtitle">${escapeHTML(proj.projectLink)}</div>` : ''}
                  ${proj.description ? `<div class="resume-entry-description">${escapeHTML(proj.description)}</div>` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}
        `;
      } else {
        // القوالب الأخرى
        resumeHTML = `
          <div class="resume-header">
            <div class="resume-name">${escapeHTML(data.personalInfo.fullName) || 'الاسم الكامل'}</div>
            <div class="resume-contact">
              ${data.personalInfo.email ? `<div class="contact-item">📧 ${escapeHTML(data.personalInfo.email)}</div>` : ''}
              ${data.personalInfo.phone ? `<div class="contact-item">📱 ${escapeHTML(data.personalInfo.phone)}</div>` : ''}
              ${data.personalInfo.location ? `<div class="contact-item">📍 ${escapeHTML(data.personalInfo.location)}</div>` : ''}
              ${data.personalInfo.website ? `<div class="contact-item">🌐 ${escapeHTML(data.personalInfo.website)}</div>` : ''}
            </div>
          </div>

          ${data.personalInfo.summary ? `
            <div class="resume-section">
              <div class="resume-section-title">${t('summary')}</div>
              <div class="resume-entry-description" style="color: ${secondaryColor}">${escapeHTML(data.personalInfo.summary)}</div>
            </div>
          ` : ''}

          ${data.experience.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title" style="color: ${accentColor}">${t('experience')}</div>
              ${data.experience.map(exp => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title" style="color: ${textColor}">${escapeHTML(exp.jobTitle) || 'المسمى الوظيفي'}</div>
                    <div class="resume-entry-date" style="color: ${accentColor}">${exp.startDate || 'التاريخ'} - ${exp.endDate || 'حالياً'}</div>
                  </div>
                  <div class="resume-entry-subtitle" style="color: ${secondaryColor}">${escapeHTML(exp.company) || 'الشركة'}</div>
                  ${exp.description ? `<div class="resume-entry-description" style="color: ${secondaryColor}">${escapeHTML(exp.description)}</div>` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.education.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title" style="color: ${accentColor}">${t('education')}</div>
              ${data.education.map(edu => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title" style="color: ${textColor}">${escapeHTML(edu.degree) || 'الدرجة'} في ${escapeHTML(edu.field) || 'التخصص'}</div>
                    <div class="resume-entry-date" style="color: ${accentColor}">${edu.graduationDate || 'التاريخ'}</div>
                  </div>
                  <div class="resume-entry-subtitle" style="color: ${secondaryColor}">${escapeHTML(edu.institution) || 'المؤسسة'}</div>
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.skills.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title" style="color: ${accentColor}">${t('skills')}</div>
              <div class="resume-skills">
                ${data.skills.filter(s => s).map(skill => `
                  <span class="skill-tag" style="color: ${textColor}">${escapeHTML(skill)}</span>
                `).join('')}
              </div>
            </div>
          ` : ''}

          ${data.certifications.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title" style="color: ${accentColor}">${t('certifications')}</div>
              ${data.certifications.map(cert => `
                <div class="resume-entry">
                  <div class="resume-entry-header">
                    <div class="resume-entry-title" style="color: ${textColor}">${escapeHTML(cert.certificateName) || 'الشهادة'}</div>
                    <div class="resume-entry-date" style="color: ${accentColor}">${cert.issueDate || 'التاريخ'}</div>
                  </div>
                  <div class="resume-entry-subtitle" style="color: ${secondaryColor}">${escapeHTML(cert.issuer) || 'الجهة'}</div>
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${data.projects.length > 0 ? `
            <div class="resume-section">
              <div class="resume-section-title" style="color: ${accentColor}">${t('projects')}</div>
              ${data.projects.map(proj => `
                <div class="resume-entry">
                  <div class="resume-entry-title" style="color: ${textColor}">${escapeHTML(proj.projectName) || 'المشروع'}</div>
                  ${proj.projectLink ? `<div class="resume-entry-subtitle" style="color: ${secondaryColor}">🔗 ${escapeHTML(proj.projectLink)}</div>` : ''}
                  ${proj.description ? `<div class="resume-entry-description" style="color: ${secondaryColor}">${escapeHTML(proj.description)}</div>` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}
        `;
      }

      previewSection.innerHTML = resumeHTML;
    }

    function togglePreviewMode(mode) {
      const previewSection = document.getElementById('preview-section');
      if (mode === 'text') {
        const text = previewSection.innerText;
        previewSection.innerHTML = `<div class="resume-text-view">${text}</div>`;
      } else {
        updatePreview();
      }
    }

    function selectTemplate(templateKey) {
      AppState.currentTemplate = templateKey;
      
      // التحقق من توافق القالب مع نظام ATS المختار
      const atsSystem = ATSSystems[AppState.selectedATS];
      const template = ResumeTemplates[templateKey];
      
      if (template.compatibility === 'low' && atsSystem.compatibility !== 'high') {
        showNotification('هذا القالب غير متوافق مع نظام ATS المختار. نوصي باستخدام قالب آخر.', 'warning');
      }
      
      saveToLocalStorage();
      
      if (AppState.currentPage === 'builder') {
        updatePreview();
      }
    }

    function toggleLanguage() {
      const newLang = AppState.currentLanguage === 'ar' ? 'en' : 'ar';
      setLanguage(newLang);
    }

    function saveDraft() {
      if (!validateResumeData()) {
        return;
      }
      saveToLocalStorage();
      showNotification('تم حفظ السيرة كمسودة بنجاح', 'success');
    }

    function validateResumeData() {
      const errors = [];
      
      if (!AppState.resumeData.personalInfo.fullName.trim()) {
        errors.push('الاسم الكامل مطلوب');
      }
      
      if (!AppState.resumeData.personalInfo.email.trim()) {
        errors.push('البريد الإلكتروني مطلوب');
      } else if (!isValidEmail(AppState.resumeData.personalInfo.email)) {
        errors.push('البريد الإلكتروني غير صالح');
      }
      
      if (errors.length > 0) {
        showNotification(errors.join('\n'), 'error');
        return false;
      }
      
      return true;
    }

    function isValidEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    function handlePhotoUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          AppState.resumeData.photo = e.target.result;
          saveToLocalStorage();
        };
        reader.readAsDataURL(file);
      }
    }

    function handleLogin(event) {
      event.preventDefault();
      AppState.userAuth.isLoggedIn = true;
      AppState.userAuth.username = event.target.email.value;
      saveToLocalStorage();
      showNotification('تم تسجيل الدخول بنجاح', 'success');
      navigateTo('dashboard');
    }

    function handleSignup(event) {
      event.preventDefault();
      showNotification('تم إنشاء الحساب بنجاح! يمكنك الآن تسجيل الدخول.', 'success');
      AppState.authMode = 'login';
      renderPage();
    }

    function handleContactSubmit(event) {
      event.preventDefault();
      showNotification('تم إرسال رسالتك بنجاح! سنتواصل معك قريباً.', 'success');
      event.target.reset();
    }

    function switchAuthMode(mode) {
      AppState.authMode = mode;
      renderPage();
    }

    function logout() {
      AppState.userAuth.isLoggedIn = false;
      AppState.userAuth.username = '';
      saveToLocalStorage();
      showNotification('تم تسجيل الخروج بنجاح', 'success');
      navigateTo('home');
    }

    function toggleMobileMenu() {
      const mobileMenu = document.querySelector('.mobile-menu');
      const overlay = document.querySelector('.mobile-menu-overlay');
      
      if (mobileMenu && overlay) {
        mobileMenu.classList.toggle('active');
        overlay.classList.toggle('active');
      }
    }

    function closeMobileMenu() {
      const mobileMenu = document.querySelector('.mobile-menu');
      const overlay = document.querySelector('.mobile-menu-overlay');
      
      if (mobileMenu && overlay) {
        mobileMenu.classList.remove('active');
        overlay.classList.remove('active');
      }
    }

    function attachEventListeners() {
      const atsSelect = document.getElementById('ats-select');
      if (atsSelect) {
        atsSelect.addEventListener('change', (e) => {
          AppState.selectedATS = e.target.value;
          
          // اقتراح أفضل قالب لنظام ATS المختار
          const atsSystem = ATSSystems[AppState.selectedATS];
          if (atsSystem.bestTemplate && AppState.currentTemplate !== atsSystem.bestTemplate) {
            AppState.currentTemplate = atsSystem.bestTemplate;
            const templateSelect = document.getElementById('template-select');
            if (templateSelect) {
              templateSelect.value = atsSystem.bestTemplate;
            }
            showNotification(`تم اختيار القالب الأنسب لنظام ${atsSystem.name}`, 'info');
          }
          
          renderPage();
        });
      }

      const templateSelect = document.getElementById('template-select');
      if (templateSelect) {
        templateSelect.addEventListener('change', (e) => {
          selectTemplate(e.target.value);
          updatePreview();
        });
      }
    }

    function updatePageContent() {
      renderPage();
    }

    // تصدير السيرة إلى PDF مع إصلاح شامل
    function exportPDF() {
      const preview = document.getElementById('preview-section');
      if (!preview) {
        showNotification('لا يوجد محتوى للمعاينة للتصدير', 'error');
        return;
      }

      if (!validateResumeData()) {
        return;
      }

      showLoadingIndicator(true);

      const filename = (AppState.resumeData.personalInfo.fullName || 'cv') + '.pdf';
      const template = AppState.currentTemplate;
      
      // إعدادات مختلفة حسب القالب
      let opt = {
        margin: template === 'ats-simple' ? 5 : 10,
        filename: filename,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { 
          scale: 2, 
          useCORS: true,
          letterRendering: true,
          logging: false
        },
        jsPDF: { 
          unit: 'mm', 
          format: 'a4', 
          orientation: 'portrait',
          compress: true
        },
        pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
      };

      // إضافة كلاس خاص للطباعة
      preview.classList.add('pdf-export');

      const runExport = () => {
        try {
          html2pdf().set(opt).from(preview).save()
            .then(() => {
              preview.classList.remove('pdf-export');
              showLoadingIndicator(false);
              showNotification('تم تصدير السيرة الذاتية بنجاح', 'success');
            })
            .catch(error => {
              preview.classList.remove('pdf-export');
              showLoadingIndicator(false);
              console.error('Export error:', error);
              showNotification('فشل التصدير: ' + error.message, 'error');
            });
        } catch (error) {
          preview.classList.remove('pdf-export');
          showLoadingIndicator(false);
          console.error('Export error:', error);
          showNotification('خطأ في التصدير: ' + error.message, 'error');
        }
      };

      if (typeof html2pdf !== 'undefined') {
        runExport();
      } else {
        const s = document.createElement('script');
        s.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js';
        s.onload = () => runExport();
        s.onerror = () => {
          preview.classList.remove('pdf-export');
          showLoadingIndicator(false);
          showNotification('فشل تحميل مكتبة التصدير', 'error');
        };
        document.head.appendChild(s);
      }
    }

    // ============ تهيئة التطبيق ============

    function initApp() {
      loadFromLocalStorage();

      // إذا لم تكن هناك بيانات، استخدم البيانات الافتراضية
      if (!AppState.resumeData.personalInfo.fullName) {
        AppState.resumeData = JSON.parse(JSON.stringify(SampleData));
      }

      // عرض الصفحة الرئيسية
      renderPage();
      
      // عرض القسم الأول تلقائياً في صفحة الباني
      if (AppState.currentPage === 'builder') {
        setTimeout(() => {
          switchSection('personal');
        }, 500);
      }
    }

    // تشغيل التطبيق عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', initApp);

    // إغلاق القائمة المتنقلة عند الضغط خارجها
    document.addEventListener('click', (e) => {
      const mobileMenu = document.querySelector('.mobile-menu');
      const overlay = document.querySelector('.mobile-menu-overlay');
      const toggleBtn = document.querySelector('.mobile-nav-toggle');
      
      if (mobileMenu && overlay && !mobileMenu.contains(e.target) && !toggleBtn.contains(e.target)) {
        closeMobileMenu();
      }
    });

    // حفظ تلقائي كل 30 ثانية
    setInterval(() => {
      if (AppState.currentPage === 'builder') {
        saveToLocalStorage();
      }
    }, 30000);
  </script>
</body>
</html>